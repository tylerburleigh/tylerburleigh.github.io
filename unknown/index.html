<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tyler Burleigh">
<meta name="dcterms.date" content="2025-01-24">
<meta name="description" content="I’m an AI engineer and this is my blog.">

<title>Analysis of the GenAI/LLM job market in January 2025 | Tyler Burleigh – Tyler Burleigh</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//files/favico.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dd08061cb7210c315e315379d94beb87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1f84303a6b4423b6cbd3f2cacdf6faa2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PRHQZ8HPLB"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PRHQZ8HPLB', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Tyler Burleigh</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/users/tylerburleigh" rel="me"> <i class="bi bi-mastodon" role="img" aria-label="mastodon">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/tylerburleigh.bsky.social" rel="me"> <i class="bi bi-square" role="img" aria-label="bluesky">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tylerburleigh" rel="me"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/tylerburleigh" rel="me"> <i class="bi bi-linkedin" role="img" aria-label="linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:tylerburleigh@gmail.com" rel="me"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of the GenAI/LLM job market in January 2025</h1>
  <div class="quarto-categories">
    <div class="quarto-category">prompt-engineering</div>
    <div class="quarto-category">python</div>
    <div class="quarto-category">job-market</div>
    <div class="quarto-category">GenAI</div>
    <div class="quarto-category">LLM</div>
  </div>
  </div>

<div>
  <div class="description">
    A data-driven exploration of the GenAI/LLM job market for science and engineering roles in January 2025. I scrape ~1000 job postings from ai-jobs.net, perform data extraction and classification using LLMs, and then analyze the data to identify patterns and insights about the GenAI/LLM job market, including salary ranges, skill requirements, and role distribution.
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>As someone currently working in a “Prompt Engineering” role, I’ve been thinking a lot about how this title basically doesn’t exist outside of a handful of companies, how the title communicates a narrow range of skills and responsibilities,and how the work that I do day-to-day is much larger in scope than just writing prompts. I identify more as an AI Engineer or AI Research Scientist, and so I was interested to see what I could learn about other similar roles that work with GenAI and LLMs.</p>
<p>So with that motivation, I set about to collect some data and look at the job market for these sorts of roles. What responsibilities and skills are being advertised most often, what kinds of titles are being used for these roles, and what kind of compensation is being offered at different levels of seniority?</p>
<p>To accomplish this, I built a custom web scraper to collect ~1000 job postings from ai-jobs.net. My code gathers job details like the title, company, location, salary, and posting date – from a range of U.S. and Canadian cities, covering entry-level, mid-level, and senior positions. I then use a Large Language Model (LLM) to extract each job’s key responsibilities, required skills, and qualifications. Afterwards, I classify each position to see whether it involves working with Generative AI or large language models, and if so, categorize it further into four major AI roles: (1) AI Research Scientist, (2) AI/ML Engineer, (3) MLOps/AI Infrastructure Engineer, and (4) AI Solution Architect. I believe this set of roles is a good representation of different areas of focus.</p>
<p>Finally, I integrate the various metadata and classifications into a comprehensive dataset. I observe that GenAI/LLM positions command consistently high salary ranges across the four different roles, particularly at more senior levels. Senior-level roles tended to offer median salaries in the $195K–$210K range, while mid-level roles generally clustered around $165K–$180K. Entry-level salaries showed greater variation (likely due to the small sample size) but still landed in competitive ranges of roughly $155K–$205K in many postings. These roles often share common technical demands—like proficiency with large-scale model training, distributed computing, and LLM-specific knowledge—though each role emphasizes distinct priorities (research vs.&nbsp;production, for example).</p>
<p>Of course, this analysis is not without limitations. For example, I am relying on a single job board, and I scraped jobs during a limited window of time. I also have not rigorously validated the LLM classifications – although I have implemented many prompt engineering best practices, and have used some of the more powerful LLMs (4o and o1). To some extent, the responsibilities and skills that were recovered from the original job postings classified into the four pre-defined roles do speak to the relative accuracy of the role classifications. The salary analysis also does not distinguish between base salary and total compensation, remote vs.&nbsp;in-person opportunities, large vs.&nbsp;small companies, and so on. But overall, I think this gives some sense of the job market for these roles.</p>
</section>
<section id="scraping-job-postings" class="level1">
<h1>Scraping job postings</h1>
<p>I’ll scrape job postings from ai-jobs.net. This is an aggregator that specializes in AI jobs of all kinds, sourcing jobs from over 60 countries, and in my experience, it does a pretty good job.</p>
<p>The code below implements a web scraper for job postings from ai-jobs.net. It collects job postings from major cities in the US and Canada, searching across entry-level, mid-level, and senior positions. For each job, it gets the title, company, location, salary, description, and posting date. The scraper saves each job as a JSON file and keeps track of what it has already scraped to avoid duplicates. It includes error handling and logging to track any problems that occur during scraping.</p>
<div id="adb1b7ee" class="cell" data-code-fold-show="false" data-execution_count="1">
<details class="code-fold">
<summary>Click to view the Job Posting Scraper code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Optional, Set</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobData:</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Structured container for job posting data"""</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    title: <span class="bu">str</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    company: <span class="bu">str</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    location: <span class="bu">str</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    level: Optional[<span class="bu">str</span>]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    salary: Optional[<span class="bu">str</span>]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    url: <span class="bu">str</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    description: <span class="bu">str</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    scraped_date: <span class="bu">str</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    posted_date: Optional[<span class="bu">str</span>]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    raw_data: <span class="bu">str</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ScrapeConfig:</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Configuration settings for the scraper"""</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    EXPERIENCE_LEVELS <span class="op">=</span> [<span class="st">'EN'</span>, <span class="st">'MI'</span>, <span class="st">'SE'</span>]  <span class="co"># Entry, Mid, Senior</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    CITIES <span class="op">=</span> {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'5391959'</span>: <span class="st">'San Francisco'</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'5128581'</span>: <span class="st">'New York City'</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'6167865'</span>: <span class="st">'Toronto'</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'6173331'</span>: <span class="st">'Vancouver'</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'5809844'</span>: <span class="st">'Seattle'</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'4671654'</span>: <span class="st">'Austin'</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'4930956'</span>: <span class="st">'Boston'</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'5'</span>: <span class="st">'Region'</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    CATEGORIES <span class="op">=</span> {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'1'</span>: <span class="st">'Research'</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'2'</span>: <span class="st">'Engineering'</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">'18'</span>: <span class="st">'GenerativeAI'</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    BASE_URL <span class="op">=</span> <span class="st">"https://ai-jobs.net"</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalaryExtractor:</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles salary extraction logic"""</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_from_schema(schema_data: Dict) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract salary from schema.org data"""</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> schema_data <span class="kw">and</span> <span class="st">'baseSalary'</span> <span class="kw">in</span> schema_data:</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                base_salary <span class="op">=</span> schema_data.get(<span class="st">'baseSalary'</span>, {}).get(<span class="st">'value'</span>, {})</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> base_salary:</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                    min_value <span class="op">=</span> base_salary.get(<span class="st">'minValue'</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                    max_value <span class="op">=</span> base_salary.get(<span class="st">'maxValue'</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                    currency <span class="op">=</span> base_salary.get(<span class="st">'currency'</span>, <span class="st">'USD'</span>)  <span class="co"># Default to USD if not specified</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> min_value <span class="kw">and</span> max_value:</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>currency<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">float</span>(min_value)<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K - </span><span class="sc">{</span><span class="bu">float</span>(max_value)<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K"</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> min_value:</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>currency<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">float</span>(min_value)<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K+"</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            logging.debug(<span class="ss">f"Error extracting schema salary: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_from_text(description: <span class="bu">str</span>) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract salary from description text"""</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> [</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r'(?:salary range.*?)(?:CAD|\$)?([\d,]+)\s*-\s*(?:CAD|\$)?([\d,]+)'</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r'(?:salary.*?)(?:CAD|\$)?([\d,]+)(?:\s*-\s*(?:CAD|\$)?([\d,]+))?'</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> match <span class="op">:=</span> re.search(pattern, description, re.IGNORECASE):</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>                    groups <span class="op">=</span> match.groups()</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Check if salary is in CAD</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                    currency <span class="op">=</span> <span class="st">'CAD'</span> <span class="cf">if</span> <span class="st">'CAD'</span> <span class="kw">in</span> description.upper() <span class="cf">else</span> <span class="st">'USD'</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">len</span>(groups) <span class="op">==</span> <span class="dv">2</span> <span class="kw">and</span> groups[<span class="dv">1</span>]:  <span class="co"># Range format</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                        min_sal <span class="op">=</span> <span class="bu">float</span>(groups[<span class="dv">0</span>].replace(<span class="st">','</span>, <span class="st">''</span>))</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                        max_sal <span class="op">=</span> <span class="bu">float</span>(groups[<span class="dv">1</span>].replace(<span class="st">','</span>, <span class="st">''</span>))</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>currency<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>min_sal<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K - </span><span class="sc">{</span>max_sal<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K"</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> groups[<span class="dv">0</span>]:  <span class="co"># Single value format</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                        base_sal <span class="op">=</span> <span class="bu">float</span>(groups[<span class="dv">0</span>].replace(<span class="st">','</span>, <span class="st">''</span>))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>currency<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>base_sal<span class="op">/</span><span class="dv">1000</span><span class="sc">:.0f}</span><span class="ss">K+"</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract(cls, soup: BeautifulSoup, description: <span class="bu">str</span>, schema_data: Dict) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Main salary extraction method"""</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Try schema data first</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> salary <span class="op">:=</span> cls.extract_from_schema(schema_data):</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> salary</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Try description text</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> salary <span class="op">:=</span> cls.extract_from_text(description):</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> salary</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Try salary badge</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> salary_badge <span class="op">:=</span> soup.find(<span class="st">'span'</span>, class_<span class="op">=</span><span class="st">'badge rounded-pill text-bg-success'</span>):</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>            salary_text <span class="op">=</span> salary_badge.text.strip()</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(<span class="vs">r'(USD|\$|\d)'</span>, salary_text):</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> salary_text</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobPageParser:</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles parsing of individual job pages"""</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, html: <span class="bu">str</span>):</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.soup <span class="op">=</span> BeautifulSoup(html, <span class="st">'html.parser'</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.raw_html <span class="op">=</span> html</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_schema_data(<span class="va">self</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Parse schema.org JSON-LD data"""</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> script <span class="op">:=</span> <span class="va">self</span>.soup.find(<span class="st">'script'</span>, <span class="bu">type</span><span class="op">=</span><span class="st">'application/ld+json'</span>):</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>                cleaned_script <span class="op">=</span> re.sub(<span class="vs">r'[\x00-\x1F\x7F-\x9F]'</span>, <span class="st">''</span>, script.string)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> json.loads(cleaned_script)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>                logging.warning(<span class="ss">f"Could not parse JSON-LD data: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {}</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_job_data(<span class="va">self</span>, url: <span class="bu">str</span>) <span class="op">-&gt;</span> JobData:</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract all job data from the page"""</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        schema_data <span class="op">=</span> <span class="va">self</span>.parse_schema_data()</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        scraped_date <span class="op">=</span> datetime.now().isoformat()</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get company name from schema or fallback to page element</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        company <span class="op">=</span> schema_data.get(<span class="st">'hiringOrganization'</span>, {}).get(<span class="st">'name'</span>)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> company:</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> company_elem <span class="op">:=</span> <span class="va">self</span>.soup.find(<span class="st">'a'</span>, class_<span class="op">=</span><span class="st">'company-name'</span>):</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>                company <span class="op">=</span> company_elem.text.strip()</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get job level from meta description</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>        level <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> meta_desc <span class="op">:=</span> <span class="va">self</span>.soup.find(<span class="st">'meta'</span>, {<span class="st">'name'</span>: <span class="st">'description'</span>}):</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> level_match <span class="op">:=</span> re.search(<span class="vs">r'a ([\w-]+level)'</span>, meta_desc[<span class="st">'content'</span>]):</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                level <span class="op">=</span> level_match.group(<span class="dv">1</span>).replace(<span class="st">'-'</span>, <span class="st">'-level / '</span>).title()</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> JobData(</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="va">self</span>.soup.find(<span class="st">'h1'</span>, class_<span class="op">=</span><span class="st">'display-5'</span>).text.strip(),</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>            company<span class="op">=</span>company,</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>            location<span class="op">=</span><span class="va">self</span>.soup.find(<span class="st">'h3'</span>, class_<span class="op">=</span><span class="st">'lead'</span>).text.strip(),</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>level,</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>            salary<span class="op">=</span>SalaryExtractor.extract(</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.soup,</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.soup.find(<span class="st">'div'</span>, class_<span class="op">=</span><span class="st">'job-description-text'</span>).text.strip(),</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>                schema_data</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>            url<span class="op">=</span>url,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>            description<span class="op">=</span><span class="va">self</span>.soup.find(<span class="st">'div'</span>, class_<span class="op">=</span><span class="st">'job-description-text'</span>).text.strip(),</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>            scraped_date<span class="op">=</span>scraped_date,</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>            posted_date<span class="op">=</span><span class="va">self</span>.calculate_posted_date(scraped_date),</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>            raw_data<span class="op">=</span><span class="va">self</span>.raw_html</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_posted_date(<span class="va">self</span>, scraped_date_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Calculate posting date from 'posted X time ago' text"""</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> match <span class="op">:=</span> re.search(<span class="vs">r'Posted (\d+) (hours?|days?|weeks?|months?) ago'</span>, <span class="va">self</span>.raw_html):</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>            number <span class="op">=</span> <span class="bu">int</span>(match.group(<span class="dv">1</span>))</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>            unit <span class="op">=</span> match.group(<span class="dv">2</span>)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>            scraped_date <span class="op">=</span> datetime.fromisoformat(scraped_date_str)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>            delta <span class="op">=</span> {</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>                <span class="st">'hour'</span>: timedelta(hours<span class="op">=</span>number),</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>                <span class="st">'day'</span>: timedelta(days<span class="op">=</span>number),</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>                <span class="st">'week'</span>: timedelta(weeks<span class="op">=</span>number),</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>                <span class="st">'month'</span>: timedelta(days<span class="op">=</span>number <span class="op">*</span> <span class="dv">30</span>)  <span class="co"># Approximate</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>            }.get(unit.rstrip(<span class="st">'s'</span>))</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> delta:</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> (scraped_date <span class="op">-</span> delta).isoformat()</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AIJobScraper:</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Main scraper orchestration class"""</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">'json_data'</span>):</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> Path(output_dir)</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.session <span class="op">=</span> requests.Session()</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> ScrapeConfig()</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.existing_jobs <span class="op">=</span> <span class="va">self</span>._load_existing_jobs()</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _load_existing_jobs(<span class="va">self</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load set of existing job URLs"""</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        existing_jobs <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> f <span class="kw">in</span> <span class="va">self</span>.output_dir.glob(<span class="st">'*.json'</span>):</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.loads(f.read_text())</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>                existing_jobs.add(data[<span class="st">'url'</span>])</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>                logging.warning(<span class="ss">f"Error reading </span><span class="sc">{</span>f<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> existing_jobs</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _generate_search_urls(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate all search URL combinations"""</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>        urls <span class="op">=</span> []</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> exp <span class="kw">in</span> <span class="va">self</span>.config.EXPERIENCE_LEVELS:</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> cat <span class="kw">in</span> <span class="va">self</span>.config.CATEGORIES:</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> city <span class="kw">in</span> <span class="va">self</span>.config.CITIES:</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>                    url <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config<span class="sc">.</span>BASE_URL<span class="sc">}</span><span class="ss">/?"</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>                    url <span class="op">+=</span> <span class="ss">f"cat=</span><span class="sc">{</span>cat<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>                    url <span class="op">+=</span> <span class="ss">f"&amp;</span><span class="sc">{</span><span class="st">'reg'</span> <span class="cf">if</span> city <span class="op">==</span> <span class="st">'5'</span> <span class="cf">else</span> <span class="st">'cit'</span><span class="sc">}</span><span class="ss">=</span><span class="sc">{</span>city<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>                    url <span class="op">+=</span> <span class="ss">f"&amp;typ=1&amp;key=&amp;exp=</span><span class="sc">{</span>exp<span class="sc">}</span><span class="ss">&amp;sal="</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>                    urls.append(url)</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> urls</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_job_urls(<span class="va">self</span>, search_url: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Get all job URLs from a search page"""</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="va">self</span>.session.get(search_url)</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>            soup <span class="op">=</span> BeautifulSoup(response.text, <span class="st">'html.parser'</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> job_list <span class="op">:=</span> soup.find(<span class="st">'ul'</span>, <span class="bu">id</span><span class="op">=</span><span class="st">'job-list'</span>):</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> [</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f"</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config<span class="sc">.</span>BASE_URL<span class="sc">}{</span>link[<span class="st">'href'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> link <span class="kw">in</span> job_list.find_all(<span class="st">'a'</span>, href<span class="op">=</span><span class="kw">lambda</span> h: h <span class="kw">and</span> <span class="st">'/job/'</span> <span class="kw">in</span> h)</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Error fetching job URLs: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> scrape_job_details(<span class="va">self</span>, url: <span class="bu">str</span>) <span class="op">-&gt;</span> Optional[JobData]:</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Scrape details from a job page"""</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="va">self</span>.session.get(url)</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>            parser <span class="op">=</span> JobPageParser(response.text)</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> parser.parse_job_data(url)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Error scraping job </span><span class="sc">{</span>url<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_job(<span class="va">self</span>, job: JobData) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Save job data to JSON file"""</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> re.sub(<span class="vs">r'[^\w\s-]'</span>, <span class="st">''</span>, job.title)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>            safe_company <span class="op">=</span> re.sub(<span class="vs">r'[^\w\s-]'</span>, <span class="st">''</span>, job.company <span class="kw">or</span> <span class="st">'unknown'</span>)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>safe_company<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span><span class="bu">hash</span>(job.url)<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.output_dir.joinpath(filename).write_text(</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>                json.dumps(<span class="bu">vars</span>(job), indent<span class="op">=</span><span class="dv">2</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Saved job: </span><span class="sc">{</span>job<span class="sc">.</span>title<span class="sc">}</span><span class="ss"> at </span><span class="sc">{</span>job<span class="sc">.</span>company<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Error saving job: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> scrape_jobs(<span class="va">self</span>, test: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Main scraping method"""</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>        jobs_found <span class="op">=</span> jobs_skipped <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> search_url <span class="kw">in</span> <span class="va">self</span>._generate_search_urls():</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>            logging.debug(<span class="ss">f"Processing search URL: </span><span class="sc">{</span>search_url<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>            job_urls <span class="op">=</span> <span class="va">self</span>.get_job_urls(search_url)</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> test <span class="kw">and</span> job_urls:</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>                job_urls <span class="op">=</span> job_urls[:<span class="dv">1</span>]</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> url <span class="kw">in</span> job_urls:</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> url <span class="kw">in</span> <span class="va">self</span>.existing_jobs:</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>                    jobs_skipped <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> job_data <span class="op">:=</span> <span class="va">self</span>.scrape_job_details(url):</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.save_job(job_data)</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.existing_jobs.add(url)</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>                    jobs_found <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">1</span>)  <span class="co"># Rate limiting</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found </span><span class="sc">{</span>jobs_found<span class="sc">}</span><span class="ss"> new jobs. Skipped </span><span class="sc">{</span>jobs_skipped<span class="sc">}</span><span class="ss"> existing jobs."</span>)</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">'jobs_found'</span>: jobs_found, <span class="st">'jobs_skipped'</span>: jobs_skipped}</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scrape_jobs(test: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, verbose: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Convenience function to run the scraper"""</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> verbose:</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.WARNING)</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>        scraper <span class="op">=</span> AIJobScraper(output_dir<span class="op">=</span>Path.cwd() <span class="op">/</span> <span class="st">'json_data'</span>)</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> scraper.scrape_jobs(test<span class="op">=</span>test)</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"Scraper failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="22ec2527" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#logging.basicConfig(level=logging.INFO)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#scraper = AIJobScraper()</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scrape_results = scraper.scrape_jobs(test=False)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(f"Found {scrape_results['jobs_found']} new jobs, skipped {scrape_results['jobs_skipped']} existing jobs")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="general-purpose-llm-completion-function" class="level1">
<h1>General-purpose LLM completion function</h1>
<p>For the classification tasks, I’ll write a general-purpose LLM completion function. This function takes a prompt and a model as parameters, and returns the completion from the OpenAI API.</p>
<div id="c787da0b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> AsyncOpenAI</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> get_completion(prompt: <span class="bu">str</span>, model: <span class="bu">str</span> <span class="op">=</span> <span class="st">"gpt-4o-2024-08-06"</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get a completion from the OpenAI API."""</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> AsyncOpenAI(api_key<span class="op">=</span>os.getenv(<span class="st">'OPENAI_API_KEY'</span>))  <span class="co"># Initialize with API key from env vars</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> <span class="cf">await</span> client.chat.completions.create(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        model<span class="op">=</span>model,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"system"</span>, <span class="st">"content"</span>: prompt}],</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        temperature<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response.choices[<span class="dv">0</span>].message.content</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extract-responsibilities-skills-and-qualifications" class="level1">
<h1>Extract Responsibilities, Skills, and Qualifications</h1>
<p>The code below uses an LLM to extract key information from job postings that will be used to classify them into different role categories. It uses OpenAI’s GPT-4o model to analyze job descriptions and extract three key components: responsibilities, skills, and qualifications. The system processes multiple jobs concurrently with rate limiting, saves the extracted data as JSON files, and includes retry logic for handling API rate limits. The code uses <code>asyncio</code> for concurrent processing and includes error handling and logging. It also checks for previously processed jobs to avoid duplicate work.</p>
<p>Also included is code that implements data preprocessing steps. This code has functions to load JSON files into a pandas DataFrame, uses a list of keywords to filter out certain jobs that are not relevant to the analysis, and removes duplicate or highly similar job descriptions using TF-IDF vectorization and cosine similarity. The main function <code>process_job_listings()</code> combines these steps, taking a directory path, similarity threshold, and filter keywords as parameters. It returns a dictionary containing the processed DataFrame along with counts of the original and filtered entries.</p>
<div id="7aac7168" class="cell" data-code-fold-show="false" data-execution_count="4">
<details class="code-fold">
<summary>Click to view the code for LLM extraction</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nest_asyncio</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Optional</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tenacity <span class="im">import</span> retry, stop_after_attempt, wait_exponential, retry_if_exception_type</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> AsyncOpenAI, RateLimitError</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable nested event loops for Jupyter notebooks</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>nest_asyncio.<span class="bu">apply</span>()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up logging configuration</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.INFO,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>PROMPTS <span class="op">=</span> {</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prompt"</span>: <span class="st">"""</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">    You will be given a Job Description.</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="st">    Your task is to extract a list of Responsibilities,</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="st">    Skills, and Qualifications. </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="st">    - Responsibilities are the tasks and activities that the job requires the employee to perform.</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="st">    - Skills are the abilities and knowledge that the employee needs to have to perform the responsibilities.</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="st">    - Qualifications are the requirements that the employee needs to meet to be considered for the job.</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;JobDescription&gt;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="sc">{job_description}</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/JobDescription&gt;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="st">    Return a list of Responsibilities, Skills, and Qualifications as follows:</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Responsibilities&gt;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="st">    [Bullet point list of responsibilities]</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Responsibilities&gt;</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Skills&gt;</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="st">    [Bullet point list of skills]</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Skills&gt;</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Qualifications&gt;</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="st">    [Bullet point list of qualifications]</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Qualifications&gt;</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobProcessor:</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">'json_extracted_data'</span>):</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        os.makedirs(output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semaphore <span class="op">=</span> asyncio.Semaphore(<span class="dv">3</span>)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processed <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.skipped <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _parse_llm_response(<span class="va">self</span>, response: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Parse LLM response into structured data."""</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> {</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">"responsibilities"</span>: [],</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">"skills"</span>: [],</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">"qualifications"</span>: []</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>        sections <span class="op">=</span> {</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">"responsibilities"</span>: <span class="vs">r'&lt;Responsibilities&gt;\n(.*?)\n&lt;/Responsibilities&gt;'</span>,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">"skills"</span>: <span class="vs">r'&lt;Skills&gt;\n(.*?)\n&lt;/Skills&gt;'</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">"qualifications"</span>: <span class="vs">r'&lt;Qualifications&gt;\n(.*?)\n&lt;/Qualifications&gt;'</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> section, pattern <span class="kw">in</span> sections.items():</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> match <span class="op">:=</span> re.search(pattern, response, re.DOTALL):</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                result[section] <span class="op">=</span> [</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                    item.strip(<span class="st">'- '</span>) </span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> item <span class="kw">in</span> match.group(<span class="dv">1</span>).strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> item.strip(<span class="st">'- '</span>)  <span class="co"># Filter out empty items</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> extract_job_details(<span class="va">self</span>, job_id: <span class="bu">str</span>, job_description: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract structured information from job description using LLM."""</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>            prompt <span class="op">=</span> PROMPTS[<span class="st">"prompt"</span>].<span class="bu">format</span>(job_description<span class="op">=</span>job_description)</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="cf">await</span> get_completion(prompt)</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> <span class="va">self</span>._parse_llm_response(response)</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save results</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>            json_path <span class="op">=</span> os.path.join(<span class="va">self</span>.output_dir, <span class="ss">f'</span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss">.json'</span>)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(json_path, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>                json.dump(result, f, indent<span class="op">=</span><span class="dv">2</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Error extracting job details: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">"responsibilities"</span>: [], <span class="st">"skills"</span>: [], <span class="st">"qualifications"</span>: []}</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_single_job(<span class="va">self</span>, job_id: <span class="bu">str</span>, description: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process a single job with caching."""</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>        json_path <span class="op">=</span> os.path.join(<span class="va">self</span>.output_dir, <span class="ss">f'</span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss">.json'</span>)</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(json_path):</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.skipped <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>            logging.debug(<span class="ss">f"Skipping job ID </span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss"> - already processed"</span>)</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(json_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> json.load(f)</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="cf">with</span> <span class="va">self</span>.semaphore:</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.processed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f"Processing job ID: </span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="cf">await</span> <span class="va">self</span>.extract_job_details(job_id, description)</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_jobs(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]]:</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process multiple jobs concurrently."""</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>        tasks <span class="op">=</span> [</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.process_single_job(<span class="bu">str</span>(row[<span class="st">'id'</span>]), row[<span class="st">'description'</span>])</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows()</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="cf">await</span> asyncio.gather(<span class="op">*</span>tasks)</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processing complete:"</span>)</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"- New jobs processed: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>processed<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"- Skipped jobs (already processed): </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>skipped<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataPreprocessor:</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, similarity_threshold<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.similarity_threshold <span class="op">=</span> similarity_threshold</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.default_filter_keywords <span class="op">=</span> [</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dir '</span>, <span class="st">'Director'</span>, <span class="st">'Intern'</span>, <span class="st">'Data Scientist'</span>, <span class="st">'Data Science'</span>,</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Content Writer'</span>, <span class="st">'Faculty'</span>, <span class="st">'Product Owner'</span>, <span class="st">'Manager'</span>,</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Analyst'</span>, <span class="st">'Postdoctoral'</span>, <span class="st">'Postdoc'</span>, <span class="st">'Summer'</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_json_files(directory<span class="op">=</span><span class="st">'json_data'</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load JSON files into DataFrame with error handling."""</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(directory):</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Directory </span><span class="sc">{</span>directory<span class="sc">}</span><span class="ss"> does not exist"</span>)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> df</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(directory) <span class="cf">if</span> f.endswith(<span class="st">'.json'</span>)]:</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(os.path.join(directory, <span class="bu">file</span>), <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>                    data <span class="op">=</span> json.load(f)</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>                    df <span class="op">=</span> pd.concat([df, pd.DataFrame([data])], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>                logging.error(<span class="ss">f"Error loading </span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">'id'</span>] <span class="op">=</span> df[<span class="st">'url'</span>].<span class="bu">apply</span>(</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> x: <span class="ss">f"j</span><span class="sc">{</span>hashlib<span class="sc">.</span>md5(x.encode())<span class="sc">.</span>hexdigest()[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> filter_by_title(<span class="va">self</span>, df: pd.DataFrame, </span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>                       filter_keywords: Optional[List[<span class="bu">str</span>]] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Filter DataFrame by job titles."""</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> df</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>        keywords <span class="op">=</span> filter_keywords <span class="kw">or</span> <span class="va">self</span>.default_filter_keywords</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df[<span class="op">~</span>df[<span class="st">'title'</span>].<span class="bu">str</span>.contains(</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>            <span class="st">'|'</span>.join(keywords),</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>            case<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>            na<span class="op">=</span><span class="va">False</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>        )]</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> remove_similar_descriptions(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Remove similar job descriptions using TF-IDF and cosine similarity."""</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> df</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>        tfidf <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span><span class="st">'english'</span>)</span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>        tfidf_matrix <span class="op">=</span> tfidf.fit_transform(df[<span class="st">'description'</span>].fillna(<span class="st">''</span>))</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>        cosine_sim <span class="op">=</span> cosine_similarity(tfidf_matrix, tfidf_matrix)</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>        indices_to_remove <span class="op">=</span> {</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>            j <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df))</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(df))</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cosine_sim[i][j] <span class="op">&gt;</span> <span class="va">self</span>.similarity_threshold</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df.iloc[<span class="op">~</span>df.index.isin(<span class="bu">list</span>(indices_to_remove))]</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_jobs_from_dataframe(df: pd.DataFrame) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]]:</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Wrapper function to process jobs from a DataFrame."""</span></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>    processor <span class="op">=</span> JobProcessor()</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>    loop <span class="op">=</span> asyncio.get_event_loop()</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> loop.is_running():</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loop.create_task(processor.process_jobs(df))</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> asyncio.run(processor.process_jobs(df))</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_job_listings(directory<span class="op">=</span><span class="st">'json_data'</span>, similarity_threshold<span class="op">=</span><span class="fl">0.8</span>, </span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>                        filter_keywords<span class="op">=</span><span class="va">None</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Main function to process job listings."""</span></span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>    preprocessor <span class="op">=</span> DataPreprocessor(similarity_threshold)</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load and preprocess data</span></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> preprocessor.load_json_files(directory)</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>    initial_count <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>            <span class="st">'processed_data'</span>: df,</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>            <span class="st">'original_count'</span>: <span class="dv">0</span>,</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>            <span class="st">'filtered_count'</span>: <span class="dv">0</span></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> preprocessor.filter_by_title(df, filter_keywords)</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>    df_filtered <span class="op">=</span> preprocessor.remove_similar_descriptions(df)</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>        <span class="st">'processed_data'</span>: df_filtered,</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>        <span class="st">'original_count'</span>: initial_count,</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>        <span class="st">'filtered_count'</span>: <span class="bu">len</span>(df_filtered)</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e35dafb5" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> process_job_listings()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> results[<span class="st">'processed_data'</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Original count of listings: </span><span class="sc">{</span>results[<span class="st">"original_count"</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Filtered count of listings: </span><span class="sc">{</span>results[<span class="st">"filtered_count"</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>extract_jobs_from_dataframe(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original count of listings: 1712
Filtered count of listings: 1152</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>&lt;Task pending name='Task-1' coro=&lt;JobProcessor.process_jobs() running at /tmp/ipykernel_1722565/2751672584.py:118&gt;&gt;</code></pre>
</div>
</div>
</section>
<section id="classification" class="level1">
<h1>Classification</h1>
<section id="classify-jobs-as-relevant-to-genaillm-work-or-not" class="level2">
<h2 class="anchored" data-anchor-id="classify-jobs-as-relevant-to-genaillm-work-or-not">Classify jobs as relevant to GenAI/LLM work or not</h2>
<div id="d2c301b0" class="cell" data-code-fold-show="false" data-execution_count="6">
<details class="code-fold">
<summary>Click to view the code for job classification as GenAI/LLM relevant or not</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nest_asyncio</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tenacity <span class="im">import</span> retry, stop_after_attempt, wait_exponential, retry_if_exception_type</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> AsyncOpenAI</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> RateLimitError</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobClassifierGenAI:</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles classification of jobs for GenAI/LLM work"""</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    PROMPT <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">    You will be given a list of Responsibilities and</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">    Skills listed for a job. Your task is to determine</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">    if the job involves working with Generative AI (GenAI)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">    or language models (a.k.a. Large Language Models (LLMs)).</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Job&gt;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Responsibilities&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="sc">{responsibilities}</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Responsibilities&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Skills&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="sc">{skills}</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Skills&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Job&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">    Start by thinking step-by-step about the Job and its </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">    Responsibilities and Skills, and whether it involves</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">    working with Generative AI (GenAI) or language models</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">    (a.k.a. Large Language Models (LLMs)).</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">    Return your response in the following format:</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;Analysis&gt;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">    [Your analysis of the job and its Responsibilities and Skills]</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/Analysis&gt;</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;FinalAnswer&gt;</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">    true|false</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/FinalAnswer&gt;</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">'role_genai_classifications'</span>, batch_size<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch_size <span class="op">=</span> batch_size</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semaphore <span class="op">=</span> asyncio.Semaphore(batch_size)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>        os.makedirs(output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> classify_job(<span class="va">self</span>, job: Dict) <span class="op">-&gt;</span> Dict:</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Classify a single job listing"""</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Classifying job '</span><span class="sc">{</span>job[<span class="st">'filename'</span>]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>        prompt <span class="op">=</span> <span class="va">self</span>.PROMPT.<span class="bu">format</span>(</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>            responsibilities<span class="op">=</span>job[<span class="st">'responsibilities'</span>],</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>            skills<span class="op">=</span>job.get(<span class="st">'skills'</span>, <span class="st">''</span>)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="cf">await</span> get_completion(prompt)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> asyncio.sleep(<span class="dv">2</span>)  <span class="co"># Rate limiting</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Failed to classify job '</span><span class="sc">{</span>job[<span class="st">'filename'</span>]<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                <span class="op">**</span>job,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                <span class="st">'analysis'</span>: <span class="ss">f'Failed to process: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>                <span class="st">'is_genai_role'</span>: <span class="va">None</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._parse_response(job, response)</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _parse_response(<span class="va">self</span>, job: Dict, response: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Parse LLM response into structured format"""</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>        soup <span class="op">=</span> BeautifulSoup(<span class="ss">f"&lt;root&gt;</span><span class="sc">{</span>response<span class="sc">}</span><span class="ss">&lt;/root&gt;"</span>, <span class="st">'lxml-xml'</span>)</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>        analysis <span class="op">=</span> soup.find(<span class="st">'Analysis'</span>)</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>        final_answer <span class="op">=</span> soup.find(<span class="st">'FinalAnswer'</span>)</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>        is_genai_role <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> final_answer:</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>            answer_text <span class="op">=</span> final_answer.text.strip().lower()</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>            is_genai_role <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> answer_text <span class="op">==</span> <span class="st">'true'</span> <span class="cf">else</span> <span class="va">False</span> <span class="cf">if</span> answer_text <span class="op">==</span> <span class="st">'false'</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>job,</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">'analysis'</span>: analysis.text.strip() <span class="cf">if</span> analysis <span class="cf">else</span> <span class="st">''</span>,</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">'is_genai_role'</span>: is_genai_role</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_classification(<span class="va">self</span>, job_id: <span class="bu">str</span>, result: Dict) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Save classification results to file"""</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> os.path.join(<span class="va">self</span>.output_dir, <span class="ss">f"</span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss">.json"</span>)</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>            json.dump(result, f, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Saved classification for job </span><span class="sc">{</span>job_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_classified_jobs(<span class="va">self</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Get set of already classified job IDs"""</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="va">self</span>.output_dir):</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">set</span>()</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {f[:<span class="op">-</span><span class="dv">5</span>] <span class="cf">for</span> f <span class="kw">in</span> os.listdir(<span class="va">self</span>.output_dir) <span class="cf">if</span> f.endswith(<span class="st">'.json'</span>)}</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_jobs_batch(<span class="va">self</span>, jobs: List[Dict]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process a batch of jobs concurrently"""</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="kw">def</span> process_with_semaphore(job: Dict) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">async</span> <span class="cf">with</span> <span class="va">self</span>.semaphore:</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.classify_job(job)</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>                job_id <span class="op">=</span> <span class="bu">str</span>(result[<span class="st">'filename'</span>])</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.save_classification(job_id, result)</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> asyncio.gather(<span class="op">*</span>[process_with_semaphore(job) <span class="cf">for</span> job <span class="kw">in</span> jobs])</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> classify_jobs_async(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process all unclassified jobs in the DataFrame"""</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>        total_jobs <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Starting classification of </span><span class="sc">{</span>total_jobs<span class="sc">}</span><span class="ss"> jobs"</span>)</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>        classified_jobs <span class="op">=</span> <span class="va">self</span>.get_classified_jobs()</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>        jobs_to_process <span class="op">=</span> [</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>            job.to_dict() <span class="cf">for</span> idx, job <span class="kw">in</span> df.iterrows() </span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">str</span>(job[<span class="st">'filename'</span>]) <span class="kw">not</span> <span class="kw">in</span> classified_jobs</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="va">self</span>.process_jobs_batch(jobs_to_process)</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Completed classification of all </span><span class="sc">{</span>total_jobs<span class="sc">}</span><span class="ss"> jobs"</span>)</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> classify_jobs(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Main entry point for job classification"""</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="st">"Empty DataFrame provided"</span>)</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'filename'</span> <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="st">"DataFrame missing required 'filename' column"</span>)</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>        classified_jobs <span class="op">=</span> <span class="va">self</span>.get_classified_jobs()</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(classified_jobs)<span class="sc">}</span><span class="ss"> previously classified jobs"</span>)</span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>        new_jobs <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'filename'</span>].isin(classified_jobs)]</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_jobs.empty:</span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="st">"No new jobs to classify"</span>)</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Processing </span><span class="sc">{</span><span class="bu">len</span>(new_jobs)<span class="sc">}</span><span class="ss"> new jobs"</span>)</span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Skipping </span><span class="sc">{</span><span class="bu">len</span>(df) <span class="op">-</span> <span class="bu">len</span>(new_jobs)<span class="sc">}</span><span class="ss"> existing jobs"</span>)</span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>        loop <span class="op">=</span> asyncio.get_event_loop()</span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>        loop.run_until_complete(<span class="va">self</span>.classify_jobs_async(new_jobs))</span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobDataLoader:</span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles loading and preprocessing of job data"""</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> read_json_files(json_dir<span class="op">=</span><span class="st">'json_extracted_data'</span>) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Read job data from JSON files"""</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> []</span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(json_dir):</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filename.endswith(<span class="st">'.json'</span>):</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> os.path.join(json_dir, filename)</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>                        data <span class="op">=</span> json.load(f)</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>                        name <span class="op">=</span> filename[:<span class="op">-</span><span class="dv">5</span>]</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">'responsibilities'</span> <span class="kw">in</span> data <span class="kw">and</span> <span class="st">'skills'</span> <span class="kw">in</span> data:</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>                            result.append({</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'filename'</span>: name,</span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'responsibilities'</span>: data[<span class="st">'responsibilities'</span>],</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'skills'</span>: data[<span class="st">'skills'</span>]</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> json.JSONDecodeError:</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>                    logging.error(<span class="ss">f"Invalid JSON in </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>                    logging.error(<span class="ss">f"Error processing </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_classifications(input_dir<span class="op">=</span><span class="st">'role_genai_classifications'</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load classification results into DataFrame"""</span></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_dir):</span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>        all_results <span class="op">=</span> []</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(input_dir):</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> filename.endswith(<span class="st">'.json'</span>):</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(os.path.join(input_dir, filename), <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>                    classification <span class="op">=</span> json.load(f)</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>                    all_results.append(classification)</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame(all_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="63a261ae" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>loader <span class="op">=</span> JobDataLoader()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>jobs <span class="op">=</span> loader.read_json_files()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(jobs)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#classifier = JobClassifierGenAI()</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#classifier.classify_jobs(df)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load results</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#results_df = loader.load_classifications()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="classify-genaillm-jobs-into-pre-defined-categories" class="level2">
<h2 class="anchored" data-anchor-id="classify-genaillm-jobs-into-pre-defined-categories">Classify GenAI/LLM jobs into pre-defined categories</h2>
<p>For this next classification task, I’ll make the assumption that there are four types of AI engineering and science roles that are relevant to work with GenAI systems. These are:</p>
<ol type="1">
<li>AI Research Scientist</li>
<li>AI/ML Engineer</li>
<li>MLOps / AI Infrastructure Engineer</li>
<li>AI Solution Architect</li>
</ol>
<p>I’ll also include other categories that are not of interest, but may improve classification accuracy. These are:</p>
<ol start="5" type="1">
<li>Data Scientist</li>
<li>Data Engineer</li>
<li>Product Manager</li>
<li>Software Engineer</li>
</ol>
<p>The code below implements an automated job classification system that uses an LLM to categorize job postings into the eight predefined roles listed above (four GenAI-focused and four related roles). It consists of several classes that work together: JobClassifier handles the core classification logic by comparing job descriptions against detailed role templates, JobData and ClassificationResult provide structured data containers, and JobProcessor manages the overall pipeline from loading jobs to saving results. The system processes jobs concurrently using asyncio, includes error handling and rate limiting, and outputs both an analysis explaining the classification and a final numerical category (0-8) for each job, with all results saved as JSON files for further analysis.</p>
<p>Definitions of the roles can be found in the <code>JOB_DESCRIPTIONS</code> variable.</p>
<div id="24f9bc77" class="cell" data-code-fold-show="false" data-execution_count="8">
<details class="code-fold">
<summary>Click to view the code for job classification into pre-defined roles</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Optional</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nest_asyncio</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>JOB_DESCRIPTIONS <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="AI Research Scientist" number="1"&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">    Investigate and adapt cutting-edge AI methodologies (e.g., generative models, advanced prompt engineering) for applications.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">    Conduct experiments to evaluate the performance (e.g., quality, accuracy) of new AI approaches and refine existing models.</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate with AI/ML Engineers to transition successful prototypes into production.</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">    Stay current with the latest AI research and emerging trends in generative AI.</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop human-annotated datasets for training and evaluation of AI models.</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">    Deep understanding of LLMs and prompt engineering.</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong background in statistics, optimization, or related fields.</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Knowledge of experimental methods (e.g., A/B testing) and hypothesis testing.</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Knowledge of LLM evaluation methods, including algorithmic evals, human evals, or LLM-as-a-judge evals.</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="AI/ML Engineer" number="2"&gt;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="st">    Transform research output into robust, scalable AI solutions for the product or internal use.</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="st">    Productionize AI models, ensuring they meet performance and reliability requirements.</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop and maintain data pipelines for model training, inference, and monitoring.</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate closely with Research Scientists to optimize and refine model implementations.</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="st">    Proficiency in Python, Go, or similar languages.</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with API development and integration (REST, GraphQL).</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="st">    Working knowledge of software engineering best practices (version control, testing, CI/CD).</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="MLOps / AI Infrastructure Engineer" number="3"&gt;</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="st">    Ensure reliable deployment, scaling, and monitoring of AI systems in production.</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="st">    Set up CI/CD pipelines tailored for AI workflows, including model versioning and data governance.</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="st">    Monitor production models for performance, latency, and data drift, implementing necessary updates.</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="st">    Manage infrastructure for scalable AI deployments (Docker, Kubernetes, cloud services).</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong DevOps background, with tools like Docker, Kubernetes, and Terraform.</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with ML orchestration/monitoring tools (MLflow, Airflow, Prometheus).</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience optimizing compute usage (GPU/TPU) for cost-effective scaling.</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="AI Solution Architect" number="4"&gt;</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="st">    Design and orchestrate AI solutions leveraging generative models and LLM technologies to create impactful experiences and solutions that align with business objectives.</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate with subject matter experts (SMEs) to identify and refine opportunities for generative AI/LLM-based use cases.</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="st">    Assess feasibility and define high-level solution architectures, ensuring they address core business and user requirements.</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop technical proposals and roadmaps, translating complex requirements into actionable plans.</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="st">    Provide thought leadership on conversational design, user experience flow, and model interaction strategies.</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="st">    Ensure solutions comply with relevant data governance, privacy, and security considerations.</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="st">    Facilitate cross-functional collaboration, guiding teams through solution conceptualization and implementation phases.</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong understanding of LLM capabilities and prompt engineering principles.</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with conversational experience design (e.g., chatbots, voice interfaces) and user journey mapping.</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="st">    Ability to analyze business needs and translate them into feasible AI solution proposals.</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with data privacy and security best practices, especially as they pertain to AI solutions.</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="st">    Excellent communication and stakeholder management skills to align technical and non-technical teams.</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="Data Scientist" number="5"&gt; </span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="st">    Leverage statistical analysis, machine learning, and data visualization to derive actionable insights and guide data-informed decisions.</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt; </span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt; </span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform exploratory data analysis (EDA) to identify trends and patterns in large, complex datasets. </span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop and validate predictive and prescriptive models, collaborating with cross-functional teams to implement these solutions. </span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="st">    Design and execute experiments to test hypotheses, measure impact, and inform business strategies. </span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="st">    Present findings and recommendations to stakeholders in a clear, concise manner using visualizations and dashboards. </span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="st">    Work with data engineers to ensure data quality, governance, and availability. </span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt; </span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt; </span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="st">    Proficiency in Python, R, or SQL for data manipulation and analysis. </span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with common ML libraries (e.g., scikit-learn, XGBoost) and deep learning frameworks (e.g., PyTorch, TensorFlow). </span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="st">    Solid grounding in statistics, probability, and experimental design. </span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with data visualization tools (e.g., Tableau, Power BI) for communicating insights. </span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong analytical thinking and ability to translate complex data problems into business solutions. </span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt; </span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="Data Engineer" number="6"&gt;</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="st">    Design, build, and maintain scalable data pipelines and architectures that enable efficient data collection, storage, and analysis.</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop and optimize data ingestion and transformation processes (ETL/ELT), ensuring high performance and reliability.</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="st">    Implement and manage data workflows, integrating internal and external data sources.</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate with Data Scientists, AI/ML Engineers, and other stakeholders to ensure data readiness for analytics and model training.</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a><span class="st">    Monitor data pipelines for performance, reliability, and cost-effectiveness, taking corrective actions when needed.</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a><span class="st">    Maintain data quality and governance standards, including metadata management and data cataloging.</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a><span class="st">    Proficiency in Python, SQL, and distributed data processing frameworks (e.g., Spark, Kafka).</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with cloud-based data ecosystems (AWS, GCP, or Azure), and related storage/processing services (e.g., S3, BigQuery, Dataflow).</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with infrastructure-as-code and DevOps tools (Terraform, Docker, Kubernetes) for automating data platform deployments.</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong understanding of database systems (relational, NoSQL) and data modeling principles.</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a><span class="st">    Knowledge of data orchestration and workflow management tools (Airflow, Luigi, Dagster).</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="Product Manager" number="7"&gt;</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="st">    Drive the product vision and strategy, ensuring alignment with business goals and user needs while delivering impactful AI-driven solutions.</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a><span class="st">    Conduct user and market research to identify opportunities, define product requirements, and set success metrics.</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate with cross-functional teams (Engineering, Data Science, Design) to prioritize features and plan releases.</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a><span class="st">    Develop and communicate product roadmaps, ensuring stakeholders are aligned on goals and timelines.</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="st">    Monitor product performance through data analysis and user feedback, iterating on improvements and new feature ideas.</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a><span class="st">    Facilitate agile development practices, writing clear user stories and acceptance criteria.</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="st">    Strong understanding of product lifecycle management and agile methodologies (Scrum/Kanban).</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="st">    Excellent communication, negotiation, and stakeholder management skills.</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with product management and collaboration tools (e.g., Jira, Confluence, Trello).</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a><span class="st">    Analytical mindset for leveraging metrics, A/B testing, and user feedback in decision-making.</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with AI/ML concepts and the ability to translate technical possibilities into viable product features.</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Option title="Software Engineer" number="8"&gt;</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;PrimaryFocus&gt;</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a><span class="st">  Design, develop, and maintain high-quality software applications and services that address user needs and align with overall business objectives.</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/PrimaryFocus&gt;</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;KeyResponsibilities&gt;</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a><span class="st">    Collaborate with cross-functional teams (Product, Design, QA) to interpret requirements and deliver robust solutions.</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a><span class="st">    Write clean, efficient, and testable code following best practices and coding standards.</span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a><span class="st">    Participate in system architecture and design discussions, contributing to the evolution of technical roadmaps.</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform code reviews and provide constructive feedback to peers, maintaining a high bar for code quality.</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a><span class="st">    Implement and maintain CI/CD pipelines to streamline deployment and reduce manual interventions.</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a><span class="st">    Continuously improve system performance and scalability through profiling and optimization.</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/KeyResponsibilities&gt;</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;SkillsAndTools&gt;</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a><span class="st">    Proficiency in one or more programming languages (e.g., Java, Python, JavaScript, C++).</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a><span class="st">    Experience with modern frameworks/libraries (e.g., Spring Boot, Node.js, React, Django).</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a><span class="st">    Solid understanding of software design principles (e.g., SOLID, DRY) and architectural patterns (e.g., microservices).</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a><span class="st">    Familiarity with version control systems (Git), testing frameworks, and agile methodologies.</span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a><span class="st">    Working knowledge of containerization (Docker), orchestration (Kubernetes), and cloud platforms (AWS, Azure, GCP).</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/SkillsAndTools&gt;</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Option&gt;</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>PROMPTS <span class="op">=</span> {</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a><span class="st">"prompt"</span>: <span class="st">"""</span></span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a><span class="st">You will be given a list of Responsibilities and</span></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a><span class="st">Skills listed for a job. Your task is to determine</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a><span class="st">if the job is a good fit with any of the Options,</span></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a><span class="st">and if so, which one.</span></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Job&gt;</span></span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Responsibilities&gt;</span></span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a><span class="sc">{responsibilities}</span></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Responsibilities&gt;</span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Skills&gt;</span></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a><span class="sc">{skills}</span></span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Skills&gt;</span></span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Job&gt;</span></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Options&gt;</span></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a><span class="sc">{Options}</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Options&gt;</span></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a><span class="st">Start by thinking step-by-step about the Job and its </span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a><span class="st">Responsibilities and Skills, in relation to each of the </span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a><span class="st">Options.</span></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a><span class="st">Decide if the Job is a good fit with ANY of the Options.</span></span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a><span class="st">If NONE of the Options are relevant to the Job, say so and </span></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a><span class="st">return a 0 as your FinalAnswer.</span></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a><span class="st">Otherwise, decide which of the Options is the most similar</span></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a><span class="st">to the Job and return its number as your FinalAnswer.</span></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a><span class="st">Return your response in the following format:</span></span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;Analysis&gt;</span></span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a><span class="st">[Your analysis of the job and its Responsibilities and Skills, in relation each of the Options]</span></span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/Analysis&gt;</span></span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;FinalAnswer&gt;</span></span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a><span class="st">0|1|2|3|4|5|6|7|8</span></span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/FinalAnswer&gt;</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable nested event loops</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>nest_asyncio.<span class="bu">apply</span>()</span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobData:</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Represents a job posting with extracted information."""</span></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>    filename: <span class="bu">str</span></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>    responsibilities: List[<span class="bu">str</span>]</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>    skills: List[<span class="bu">str</span>]</span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ClassificationResult:</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Represents the result of a job classification."""</span></span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>    filename: <span class="bu">str</span></span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>    responsibilities: List[<span class="bu">str</span>]</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>    skills: List[<span class="bu">str</span>]</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>    analysis: <span class="bu">str</span></span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>    role_classification: Optional[<span class="bu">int</span>]</span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>    role_title: Optional[<span class="bu">str</span>]</span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobClassifier:</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles classification of jobs into predefined roles."""</span></span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">'role_classifications'</span>, batch_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span>):</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch_size <span class="op">=</span> batch_size</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.semaphore <span class="op">=</span> asyncio.Semaphore(batch_size)</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>        os.makedirs(output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> classify_job(<span class="va">self</span>, job: JobData) <span class="op">-&gt;</span> ClassificationResult:</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Classify a single job listing."""</span></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Classifying job '</span><span class="sc">{</span>job<span class="sc">.</span>filename<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>        prompt <span class="op">=</span> PROMPTS[<span class="st">"prompt"</span>].<span class="bu">format</span>(</span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>            responsibilities<span class="op">=</span>job.responsibilities,  <span class="co"># Access as attribute instead of dict</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>            skills<span class="op">=</span>job.skills,  <span class="co"># Access as attribute instead of dict</span></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>            Options<span class="op">=</span>JOB_DESCRIPTIONS</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="cf">await</span> get_completion(prompt)</span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> asyncio.sleep(<span class="dv">5</span>)  <span class="co"># Rate limiting</span></span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._parse_response(job, response)</span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Failed to classify job '</span><span class="sc">{</span>job<span class="sc">.</span>filename<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ClassificationResult(</span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>                filename<span class="op">=</span>job.filename,</span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a>                responsibilities<span class="op">=</span>job.responsibilities,</span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a>                skills<span class="op">=</span>job.skills,</span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>                analysis<span class="op">=</span><span class="ss">f'Failed to process: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>                role_classification<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>                role_title<span class="op">=</span><span class="va">None</span></span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _parse_response(<span class="va">self</span>, job: JobData, response: <span class="bu">str</span>) <span class="op">-&gt;</span> ClassificationResult:</span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Parse LLM response into structured format."""</span></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>        soup <span class="op">=</span> BeautifulSoup(<span class="ss">f"&lt;root&gt;</span><span class="sc">{</span>response<span class="sc">}</span><span class="ss">&lt;/root&gt;"</span>, <span class="st">'lxml-xml'</span>)</span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>        analysis <span class="op">=</span> soup.find(<span class="st">'Analysis'</span>)</span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>        role_choice <span class="op">=</span> soup.find(<span class="st">'FinalAnswer'</span>)</span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>        role_number <span class="op">=</span> <span class="bu">int</span>(role_choice.text.strip()) <span class="cf">if</span> role_choice <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>        role_title <span class="op">=</span> <span class="va">self</span>._get_role_title(role_number)</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ClassificationResult(</span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>            filename<span class="op">=</span>job.filename,</span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>            responsibilities<span class="op">=</span>job.responsibilities,</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>            skills<span class="op">=</span>job.skills,</span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>            analysis<span class="op">=</span>analysis.text.strip() <span class="cf">if</span> analysis <span class="cf">else</span> <span class="st">''</span>,</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>            role_classification<span class="op">=</span>role_number,</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>            role_title<span class="op">=</span>role_title</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_role_title(<span class="va">self</span>, role_number: Optional[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Get the title for a role number."""</span></span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> role_number <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> role_number <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Other"</span></span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>        wrapped_xml <span class="op">=</span> <span class="ss">f"&lt;root&gt;</span><span class="sc">{</span>JOB_DESCRIPTIONS<span class="sc">}</span><span class="ss">&lt;/root&gt;"</span></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>        job_descriptions_soup <span class="op">=</span> BeautifulSoup(wrapped_xml, <span class="st">'lxml-xml'</span>)</span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>        matching_job <span class="op">=</span> job_descriptions_soup.find(<span class="st">'Option'</span>, {<span class="st">'number'</span>: <span class="bu">str</span>(role_number)})</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> matching_job:</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> matching_job[<span class="st">'title'</span>]</span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>        logging.error(<span class="ss">f"No matching job found for role number </span><span class="sc">{</span>role_number<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JobProcessor:</span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles the processing of job data files."""</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">'json_extracted_data'</span>):</span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.input_dir <span class="op">=</span> input_dir</span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.classifier <span class="op">=</span> JobClassifier()</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_jobs(<span class="va">self</span>) <span class="op">-&gt;</span> List[JobData]:</span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load jobs from JSON files."""</span></span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>        jobs <span class="op">=</span> []</span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get list of all JSON files</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>        total_files <span class="op">=</span> <span class="bu">len</span>([f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(<span class="va">self</span>.input_dir) <span class="cf">if</span> f.endswith(<span class="st">'.json'</span>)])</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get files that were classified as GenAI-relevant</span></span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>        classified_files <span class="op">=</span> <span class="va">self</span>._get_classified_files()</span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get files that have already been processed</span></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>        processed_files <span class="op">=</span> {</span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>            f[:<span class="op">-</span><span class="dv">5</span>] <span class="cf">for</span> f <span class="kw">in</span> os.listdir(<span class="va">self</span>.classifier.output_dir) </span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> f.endswith(<span class="st">'.json'</span>)</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get relevant files that haven't been processed yet</span></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a>        files_to_process <span class="op">=</span> classified_files <span class="op">-</span> processed_files</span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found </span><span class="sc">{</span>total_files<span class="sc">}</span><span class="ss"> total files"</span>)</span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(classified_files)<span class="sc">}</span><span class="ss"> relevant GenAI files"</span>)</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Already processed: </span><span class="sc">{</span><span class="bu">len</span>(processed_files)<span class="sc">}</span><span class="ss"> files"</span>)</span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Remaining to process: </span><span class="sc">{</span><span class="bu">len</span>(files_to_process)<span class="sc">}</span><span class="ss"> files"</span>)</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Only process files that are both relevant and unprocessed</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(<span class="va">self</span>.input_dir):</span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> filename.endswith(<span class="st">'.json'</span>):</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>            name <span class="op">=</span> filename[:<span class="op">-</span><span class="dv">5</span>]</span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> name <span class="kw">not</span> <span class="kw">in</span> files_to_process:</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>                job <span class="op">=</span> <span class="va">self</span>._load_job_file(filename)</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> job:</span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>                    jobs.append(job)</span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>                logging.error(<span class="ss">f"Error processing </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Processing </span><span class="sc">{</span><span class="bu">len</span>(jobs)<span class="sc">}</span><span class="ss"> remaining jobs"</span>)</span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jobs</span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _load_job_file(<span class="va">self</span>, filename: <span class="bu">str</span>) <span class="op">-&gt;</span> Optional[JobData]:</span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load and parse a single job file."""</span></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a>        file_path <span class="op">=</span> os.path.join(<span class="va">self</span>.input_dir, filename)</span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'responsibilities'</span> <span class="kw">in</span> data <span class="kw">and</span> <span class="st">'skills'</span> <span class="kw">in</span> data:</span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> JobData(</span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a>                        filename<span class="op">=</span>filename[:<span class="op">-</span><span class="dv">5</span>],</span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>                        responsibilities<span class="op">=</span>data[<span class="st">'responsibilities'</span>],</span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>                        skills<span class="op">=</span>data[<span class="st">'skills'</span>]</span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> json.JSONDecodeError:</span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"Invalid JSON in </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_classified_files(<span class="va">self</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Get set of files that have been previously classified as GenAI-related."""</span></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a>        genai_dir <span class="op">=</span> <span class="st">'role_genai_classifications'</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(genai_dir):</span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">set</span>()</span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>        genai_files <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> f <span class="kw">in</span> os.listdir(genai_dir):</span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> f.endswith(<span class="st">'.json'</span>):</span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> <span class="bu">open</span>(os.path.join(genai_dir, f), <span class="st">'r'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>                        data <span class="op">=</span> json.load(<span class="bu">file</span>)</span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> data.get(<span class="st">'is_genai_role'</span>) <span class="kw">is</span> <span class="va">True</span>:  <span class="co"># Explicitly check for True</span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>                            genai_files.add(f[:<span class="op">-</span><span class="dv">5</span>])</span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a>                    logging.error(<span class="ss">f"Error reading </span><span class="sc">{</span>f<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> genai_files</span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_jobs(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process all jobs."""</span></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a>        jobs <span class="op">=</span> <span class="va">self</span>.load_jobs()</span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> jobs:</span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Processing </span><span class="sc">{</span><span class="bu">len</span>(jobs)<span class="sc">}</span><span class="ss"> relevant jobs"</span>)</span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="va">self</span>._process_jobs_batch(jobs)</span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="st">"Job classification complete"</span>)</span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> _process_jobs_batch(<span class="va">self</span>, jobs: List[JobData]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process a batch of jobs concurrently."""</span></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="kw">def</span> process_with_semaphore(job: JobData) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a>            <span class="cf">async</span> <span class="cf">with</span> <span class="va">self</span>.classifier.semaphore:</span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.classifier.classify_job(job)</span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>._save_result(result)</span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> asyncio.gather(<span class="op">*</span>[process_with_semaphore(job) <span class="cf">for</span> job <span class="kw">in</span> jobs])</span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _save_result(<span class="va">self</span>, result: ClassificationResult) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Save classification result to file."""</span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> os.path.join(<span class="va">self</span>.classifier.output_dir, <span class="ss">f"</span><span class="sc">{</span>result<span class="sc">.</span>filename<span class="sc">}</span><span class="ss">.json"</span>)</span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="bu">vars</span>(result), f, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Saved classification for job </span><span class="sc">{</span>result<span class="sc">.</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_job_roles(df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Main entry point for job classification."""</span></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a>        logging.warning(<span class="st">"Empty DataFrame provided"</span>)</span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a>    processor <span class="op">=</span> JobProcessor()</span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a>    loop <span class="op">=</span> asyncio.get_event_loop()</span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a>    loop.run_until_complete(processor.process_jobs())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="851caae6" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>loader <span class="op">=</span> JobDataLoader()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>jobs <span class="op">=</span> loader.read_json_files()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(jobs)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>classify_job_roles(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2025-02-02 11:09:54,741 - INFO - Found 862 total files
2025-02-02 11:09:54,741 - INFO - Found 284 relevant GenAI files
2025-02-02 11:09:54,742 - INFO - Already processed: 249 files
2025-02-02 11:09:54,742 - INFO - Remaining to process: 35 files
2025-02-02 11:09:54,745 - INFO - Processing 35 remaining jobs
2025-02-02 11:09:54,745 - INFO - Processing 35 relevant jobs
2025-02-02 11:09:54,746 - INFO - Classifying job 'j0b848'
2025-02-02 11:09:54,779 - INFO - Classifying job 'j910b7'
2025-02-02 11:09:54,809 - INFO - Classifying job 'j542d8'
2025-02-02 11:10:03,263 - INFO - Processing job ID: j06758
2025-02-02 11:10:03,263 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,264 - INFO - Processing job ID: j9c2d4
2025-02-02 11:10:03,264 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,265 - INFO - Processing job ID: j692fd
2025-02-02 11:10:03,266 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,267 - INFO - Processing job ID: j5adae
2025-02-02 11:10:03,267 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,268 - INFO - Processing job ID: jf3085
2025-02-02 11:10:03,269 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,269 - INFO - Processing job ID: j47004
2025-02-02 11:10:03,273 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,273 - INFO - Processing job ID: j0f67c
2025-02-02 11:10:03,274 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,275 - INFO - Processing job ID: jcc952
2025-02-02 11:10:03,275 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,276 - INFO - Processing job ID: j709a2
2025-02-02 11:10:03,276 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,277 - INFO - Processing job ID: jb59a3
2025-02-02 11:10:03,277 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,278 - INFO - Processing job ID: je1e51
2025-02-02 11:10:03,279 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,279 - INFO - Processing job ID: jd6ca2
2025-02-02 11:10:03,280 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,280 - INFO - Processing job ID: j3551e
2025-02-02 11:10:03,281 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,281 - INFO - Processing job ID: j98253
2025-02-02 11:10:03,282 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,283 - INFO - Processing job ID: j81e1a
2025-02-02 11:10:03,283 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,284 - INFO - Processing job ID: j92226
2025-02-02 11:10:03,285 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,289 - INFO - Processing job ID: jde156
2025-02-02 11:10:03,290 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,290 - INFO - Processing job ID: j32ed8
2025-02-02 11:10:03,291 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,293 - INFO - Processing job ID: ja71c8
2025-02-02 11:10:03,294 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,296 - INFO - Processing job ID: jf429d
2025-02-02 11:10:03,297 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,298 - INFO - Processing job ID: j740b4
2025-02-02 11:10:03,299 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,303 - INFO - Processing job ID: j5c5fc
2025-02-02 11:10:03,304 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,305 - INFO - Processing job ID: j154f9
2025-02-02 11:10:03,306 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,308 - INFO - Processing job ID: jafd84
2025-02-02 11:10:03,309 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,309 - INFO - Processing job ID: j61b8e
2025-02-02 11:10:03,310 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,311 - INFO - Processing job ID: j9b9fc
2025-02-02 11:10:03,312 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,313 - INFO - Processing job ID: jb0b36
2025-02-02 11:10:03,314 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,314 - INFO - Processing job ID: jc5818
2025-02-02 11:10:03,316 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,317 - INFO - Processing job ID: j52713
2025-02-02 11:10:03,318 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,318 - INFO - Processing job ID: jb8ba8
2025-02-02 11:10:03,320 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,321 - INFO - Processing job ID: j4584e
2025-02-02 11:10:03,321 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,322 - INFO - Processing job ID: j4215b
2025-02-02 11:10:03,323 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,323 - INFO - Processing job ID: jda7d7
2025-02-02 11:10:03,324 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,325 - INFO - Processing job ID: j81c6e
2025-02-02 11:10:03,325 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,326 - INFO - Processing job ID: j05901
2025-02-02 11:10:03,327 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,327 - INFO - Processing job ID: j1571c
2025-02-02 11:10:03,328 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,329 - INFO - Processing job ID: jac2b4
2025-02-02 11:10:03,329 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,330 - INFO - Processing job ID: jeed4f
2025-02-02 11:10:03,333 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,333 - INFO - Processing job ID: je192e
2025-02-02 11:10:03,334 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,335 - INFO - Processing job ID: ja27a3
2025-02-02 11:10:03,335 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,336 - INFO - Processing job ID: jc23ec
2025-02-02 11:10:03,337 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,338 - INFO - Processing job ID: j017b6
2025-02-02 11:10:03,340 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,341 - INFO - Processing job ID: jb86b6
2025-02-02 11:10:03,342 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,343 - INFO - Processing job ID: j5181a
2025-02-02 11:10:03,343 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,344 - INFO - Processing job ID: jfb5fd
2025-02-02 11:10:03,345 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,346 - INFO - Processing job ID: j2307d
2025-02-02 11:10:03,346 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,346 - INFO - Processing job ID: jc20c5
2025-02-02 11:10:03,347 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,348 - INFO - Processing job ID: j392d7
2025-02-02 11:10:03,350 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,351 - INFO - Processing job ID: j733dd
2025-02-02 11:10:03,351 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,353 - INFO - Processing job ID: jd7e83
2025-02-02 11:10:03,353 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,354 - INFO - Processing job ID: j97730
2025-02-02 11:10:03,355 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,356 - INFO - Processing job ID: j4d650
2025-02-02 11:10:03,357 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,357 - INFO - Processing job ID: jcf8f6
2025-02-02 11:10:03,358 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,359 - INFO - Processing job ID: jb33cb
2025-02-02 11:10:03,360 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,361 - INFO - Processing job ID: j05e1a
2025-02-02 11:10:03,362 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,362 - INFO - Processing job ID: j43198
2025-02-02 11:10:03,363 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,364 - INFO - Processing job ID: j1d67b
2025-02-02 11:10:03,365 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,366 - INFO - Processing job ID: j5406e
2025-02-02 11:10:03,367 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,370 - INFO - Processing job ID: j722dd
2025-02-02 11:10:03,372 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,373 - INFO - Processing job ID: j00cb4
2025-02-02 11:10:03,374 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,375 - INFO - Processing job ID: j52ca1
2025-02-02 11:10:03,376 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,377 - INFO - Processing job ID: j6c50c
2025-02-02 11:10:03,378 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,379 - INFO - Processing job ID: j63505
2025-02-02 11:10:03,380 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,380 - INFO - Processing job ID: j6a6e9
2025-02-02 11:10:03,382 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,382 - INFO - Processing job ID: j579cd
2025-02-02 11:10:03,383 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,384 - INFO - Processing job ID: ja2db2
2025-02-02 11:10:03,384 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,385 - INFO - Processing job ID: j9d81d
2025-02-02 11:10:03,386 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,386 - INFO - Processing job ID: j6e922
2025-02-02 11:10:03,387 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,388 - INFO - Processing job ID: jc7fba
2025-02-02 11:10:03,389 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,389 - INFO - Processing job ID: jdfe11
2025-02-02 11:10:03,390 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,391 - INFO - Processing job ID: j5cb97
2025-02-02 11:10:03,392 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,393 - INFO - Processing job ID: j9c85d
2025-02-02 11:10:03,393 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,394 - INFO - Processing job ID: jf8953
2025-02-02 11:10:03,394 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,395 - INFO - Processing job ID: j92a25
2025-02-02 11:10:03,398 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,398 - INFO - Processing job ID: j0a336
2025-02-02 11:10:03,399 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,400 - INFO - Processing job ID: j7ff3e
2025-02-02 11:10:03,401 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,402 - INFO - Processing job ID: j9a732
2025-02-02 11:10:03,403 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,404 - INFO - Processing job ID: j1c5db
2025-02-02 11:10:03,404 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,405 - INFO - Processing job ID: j4b9f6
2025-02-02 11:10:03,405 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,406 - INFO - Processing job ID: jdb635
2025-02-02 11:10:03,407 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,407 - INFO - Processing job ID: j79967
2025-02-02 11:10:03,408 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,409 - INFO - Processing job ID: j289be
2025-02-02 11:10:03,409 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,410 - INFO - Processing job ID: jffd3d
2025-02-02 11:10:03,410 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,411 - INFO - Processing job ID: jc36f2
2025-02-02 11:10:03,411 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,414 - INFO - Processing job ID: jbe3e9
2025-02-02 11:10:03,414 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,414 - INFO - Processing job ID: j92e88
2025-02-02 11:10:03,415 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,415 - INFO - Processing job ID: jff76b
2025-02-02 11:10:03,416 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,416 - INFO - Processing job ID: ja7ea0
2025-02-02 11:10:03,418 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,419 - INFO - Processing job ID: j45e53
2025-02-02 11:10:03,419 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,421 - INFO - Processing job ID: j12f0b
2025-02-02 11:10:03,421 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,424 - INFO - Processing job ID: j533ab
2025-02-02 11:10:03,425 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,426 - INFO - Processing job ID: jbad0e
2025-02-02 11:10:03,426 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,427 - INFO - Processing job ID: j5a983
2025-02-02 11:10:03,428 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,428 - INFO - Processing job ID: jd1d69
2025-02-02 11:10:03,429 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,430 - INFO - Processing job ID: jd3d8c
2025-02-02 11:10:03,431 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,431 - INFO - Processing job ID: j286a9
2025-02-02 11:10:03,432 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,433 - INFO - Processing job ID: j13a76
2025-02-02 11:10:03,435 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,436 - INFO - Processing job ID: jea48a
2025-02-02 11:10:03,436 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,437 - INFO - Processing job ID: j06715
2025-02-02 11:10:03,437 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,438 - INFO - Processing job ID: j991c8
2025-02-02 11:10:03,440 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,441 - INFO - Processing job ID: j1bf5e
2025-02-02 11:10:03,441 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,442 - INFO - Processing job ID: j2f77a
2025-02-02 11:10:03,442 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,444 - INFO - Processing job ID: j6f9bd
2025-02-02 11:10:03,445 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,446 - INFO - Processing job ID: j7ba99
2025-02-02 11:10:03,447 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,448 - INFO - Processing job ID: je5505
2025-02-02 11:10:03,450 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,451 - INFO - Processing job ID: j3eba4
2025-02-02 11:10:03,452 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,453 - INFO - Processing job ID: j86215
2025-02-02 11:10:03,454 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,456 - INFO - Processing job ID: jd25b2
2025-02-02 11:10:03,457 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,458 - INFO - Processing job ID: j5462d
2025-02-02 11:10:03,458 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,459 - INFO - Processing job ID: j7641b
2025-02-02 11:10:03,459 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,460 - INFO - Processing job ID: ja754d
2025-02-02 11:10:03,460 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,462 - INFO - Processing job ID: jb3322
2025-02-02 11:10:03,462 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,463 - INFO - Processing job ID: j928a8
2025-02-02 11:10:03,463 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,464 - INFO - Processing job ID: j442fd
2025-02-02 11:10:03,464 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,466 - INFO - Processing job ID: j2d360
2025-02-02 11:10:03,467 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,468 - INFO - Processing job ID: jb760c
2025-02-02 11:10:03,469 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,470 - INFO - Processing job ID: j8bb96
2025-02-02 11:10:03,471 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,471 - INFO - Processing job ID: j295eb
2025-02-02 11:10:03,472 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,473 - INFO - Processing job ID: j1a80f
2025-02-02 11:10:03,473 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,474 - INFO - Processing job ID: j9f7d4
2025-02-02 11:10:03,475 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,477 - INFO - Processing job ID: j69e63
2025-02-02 11:10:03,477 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,478 - INFO - Processing job ID: j88ddf
2025-02-02 11:10:03,479 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,480 - INFO - Processing job ID: j87ba0
2025-02-02 11:10:03,481 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,482 - INFO - Processing job ID: j16780
2025-02-02 11:10:03,483 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,484 - INFO - Processing job ID: j6ee8e
2025-02-02 11:10:03,485 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,486 - INFO - Processing job ID: j7e441
2025-02-02 11:10:03,487 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,488 - INFO - Processing job ID: j84365
2025-02-02 11:10:03,489 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,490 - INFO - Processing job ID: j6ef19
2025-02-02 11:10:03,493 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,493 - INFO - Processing job ID: j460c5
2025-02-02 11:10:03,494 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,494 - INFO - Processing job ID: j7dadb
2025-02-02 11:10:03,497 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,498 - INFO - Processing job ID: jfba6d
2025-02-02 11:10:03,499 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,499 - INFO - Processing job ID: j417fd
2025-02-02 11:10:03,500 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,501 - INFO - Processing job ID: j02159
2025-02-02 11:10:03,502 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,503 - INFO - Processing job ID: jc3a2c
2025-02-02 11:10:03,504 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,504 - INFO - Processing job ID: jdde0d
2025-02-02 11:10:03,507 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,508 - INFO - Processing job ID: j35719
2025-02-02 11:10:03,508 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,510 - INFO - Processing job ID: j0fb04
2025-02-02 11:10:03,511 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,512 - INFO - Processing job ID: jdf3cd
2025-02-02 11:10:03,513 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,514 - INFO - Processing job ID: j6d0d0
2025-02-02 11:10:03,515 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,515 - INFO - Processing job ID: j36892
2025-02-02 11:10:03,516 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,516 - INFO - Processing job ID: j9413b
2025-02-02 11:10:03,517 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,518 - INFO - Processing job ID: j772b4
2025-02-02 11:10:03,520 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,521 - INFO - Processing job ID: j96e4e
2025-02-02 11:10:03,521 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,522 - INFO - Processing job ID: ja56ed
2025-02-02 11:10:03,522 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,524 - INFO - Processing job ID: jd2fba
2025-02-02 11:10:03,524 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,525 - INFO - Processing job ID: j6928a
2025-02-02 11:10:03,525 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,526 - INFO - Processing job ID: j2a176
2025-02-02 11:10:03,526 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,527 - INFO - Processing job ID: j42c08
2025-02-02 11:10:03,527 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,528 - INFO - Processing job ID: jd78e7
2025-02-02 11:10:03,528 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,528 - INFO - Processing job ID: j97db4
2025-02-02 11:10:03,529 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,530 - INFO - Processing job ID: j6ac4b
2025-02-02 11:10:03,530 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,531 - INFO - Processing job ID: jecbc3
2025-02-02 11:10:03,531 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,534 - INFO - Processing job ID: j6f3a6
2025-02-02 11:10:03,534 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,536 - INFO - Processing job ID: j17f82
2025-02-02 11:10:03,537 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,538 - INFO - Processing job ID: j12635
2025-02-02 11:10:03,539 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,540 - INFO - Processing job ID: j8ea2b
2025-02-02 11:10:03,540 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,541 - INFO - Processing job ID: jd4ae5
2025-02-02 11:10:03,541 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,542 - INFO - Processing job ID: j9439c
2025-02-02 11:10:03,542 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,543 - INFO - Processing job ID: j2be84
2025-02-02 11:10:03,543 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,544 - INFO - Processing job ID: j2503e
2025-02-02 11:10:03,544 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,546 - INFO - Processing job ID: j6f698
2025-02-02 11:10:03,546 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,547 - INFO - Processing job ID: jcde3f
2025-02-02 11:10:03,547 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,548 - INFO - Processing job ID: j9f97d
2025-02-02 11:10:03,548 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,549 - INFO - Processing job ID: je04a9
2025-02-02 11:10:03,550 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,550 - INFO - Processing job ID: j13bd4
2025-02-02 11:10:03,551 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,552 - INFO - Processing job ID: j08373
2025-02-02 11:10:03,553 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,554 - INFO - Processing job ID: j1f236
2025-02-02 11:10:03,555 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,556 - INFO - Processing job ID: j4b1ea
2025-02-02 11:10:03,558 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,558 - INFO - Processing job ID: jc9ecc
2025-02-02 11:10:03,559 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,560 - INFO - Processing job ID: j2f64f
2025-02-02 11:10:03,560 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,561 - INFO - Processing job ID: j3bb38
2025-02-02 11:10:03,561 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,563 - INFO - Processing job ID: j35c38
2025-02-02 11:10:03,563 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,564 - INFO - Processing job ID: jca207
2025-02-02 11:10:03,564 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,565 - INFO - Processing job ID: jcda25
2025-02-02 11:10:03,566 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,567 - INFO - Processing job ID: j950c8
2025-02-02 11:10:03,568 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,568 - INFO - Processing job ID: j3a057
2025-02-02 11:10:03,569 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,569 - INFO - Processing job ID: j47f94
2025-02-02 11:10:03,570 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,571 - INFO - Processing job ID: j1fa13
2025-02-02 11:10:03,571 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,572 - INFO - Processing job ID: jf2b8d
2025-02-02 11:10:03,572 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,573 - INFO - Processing job ID: j4380a
2025-02-02 11:10:03,573 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,574 - INFO - Processing job ID: j2943e
2025-02-02 11:10:03,576 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,577 - INFO - Processing job ID: jd7d69
2025-02-02 11:10:03,578 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,578 - INFO - Processing job ID: j05805
2025-02-02 11:10:03,579 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,580 - INFO - Processing job ID: j18699
2025-02-02 11:10:03,580 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,581 - INFO - Processing job ID: j1c200
2025-02-02 11:10:03,581 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,582 - INFO - Processing job ID: jb3fa4
2025-02-02 11:10:03,582 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,583 - INFO - Processing job ID: je89b6
2025-02-02 11:10:03,584 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,587 - INFO - Processing job ID: jea4bf
2025-02-02 11:10:03,588 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,588 - INFO - Processing job ID: ja381c
2025-02-02 11:10:03,589 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,589 - INFO - Processing job ID: j0c5e0
2025-02-02 11:10:03,590 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,590 - INFO - Processing job ID: j587fb
2025-02-02 11:10:03,591 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,591 - INFO - Processing job ID: j9a68d
2025-02-02 11:10:03,592 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,592 - INFO - Processing job ID: jd839e
2025-02-02 11:10:03,592 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,593 - INFO - Processing job ID: j6fc3a
2025-02-02 11:10:03,594 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,595 - INFO - Processing job ID: je38db
2025-02-02 11:10:03,595 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,596 - INFO - Processing job ID: j1c235
2025-02-02 11:10:03,596 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,597 - INFO - Processing job ID: jb13d0
2025-02-02 11:10:03,597 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,597 - INFO - Processing job ID: jf1cb5
2025-02-02 11:10:03,598 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,598 - INFO - Processing job ID: j2dd0d
2025-02-02 11:10:03,599 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,599 - INFO - Processing job ID: jf88b8
2025-02-02 11:10:03,600 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,600 - INFO - Processing job ID: ja4844
2025-02-02 11:10:03,602 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,603 - INFO - Processing job ID: j94120
2025-02-02 11:10:03,603 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,604 - INFO - Processing job ID: j9c977
2025-02-02 11:10:03,604 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,605 - INFO - Processing job ID: jc5113
2025-02-02 11:10:03,605 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,606 - INFO - Processing job ID: j02aa2
2025-02-02 11:10:03,606 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,606 - INFO - Processing job ID: ja4f18
2025-02-02 11:10:03,607 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,607 - INFO - Processing job ID: jca609
2025-02-02 11:10:03,607 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,608 - INFO - Processing job ID: j83ace
2025-02-02 11:10:03,608 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,609 - INFO - Processing job ID: j5f657
2025-02-02 11:10:03,609 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,609 - INFO - Processing job ID: j8867b
2025-02-02 11:10:03,610 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,610 - INFO - Processing job ID: j9014b
2025-02-02 11:10:03,610 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,610 - INFO - Processing job ID: ja9b01
2025-02-02 11:10:03,611 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,611 - INFO - Processing job ID: j17e39
2025-02-02 11:10:03,612 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,612 - INFO - Processing job ID: ja3bdc
2025-02-02 11:10:03,612 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,613 - INFO - Processing job ID: jfde04
2025-02-02 11:10:03,613 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,613 - INFO - Processing job ID: jb4c73
2025-02-02 11:10:03,614 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,614 - INFO - Processing job ID: j02c97
2025-02-02 11:10:03,614 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,615 - INFO - Processing job ID: jb0f36
2025-02-02 11:10:03,616 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,617 - INFO - Processing job ID: j686b8
2025-02-02 11:10:03,617 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,618 - INFO - Processing job ID: jd2eb7
2025-02-02 11:10:03,618 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,619 - INFO - Processing job ID: j3214f
2025-02-02 11:10:03,619 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,620 - INFO - Processing job ID: j11255
2025-02-02 11:10:03,620 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,621 - INFO - Processing job ID: jbadd8
2025-02-02 11:10:03,621 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,622 - INFO - Processing job ID: jcdb10
2025-02-02 11:10:03,623 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,623 - INFO - Processing job ID: jf2227
2025-02-02 11:10:03,624 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,624 - INFO - Processing job ID: je5297
2025-02-02 11:10:03,625 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,626 - INFO - Processing job ID: jddf63
2025-02-02 11:10:03,626 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,627 - INFO - Processing job ID: j96f54
2025-02-02 11:10:03,627 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,628 - INFO - Processing job ID: jd14ef
2025-02-02 11:10:03,628 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,629 - INFO - Processing job ID: jc3bc5
2025-02-02 11:10:03,629 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,630 - INFO - Processing job ID: j24436
2025-02-02 11:10:03,630 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,630 - INFO - Processing job ID: j7f84d
2025-02-02 11:10:03,631 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,631 - INFO - Processing job ID: j2c41f
2025-02-02 11:10:03,632 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,632 - INFO - Processing job ID: j0c39c
2025-02-02 11:10:03,633 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,634 - INFO - Processing job ID: jbe8e9
2025-02-02 11:10:03,634 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,635 - INFO - Processing job ID: j93375
2025-02-02 11:10:03,635 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,636 - INFO - Processing job ID: jabd9c
2025-02-02 11:10:03,636 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,637 - INFO - Processing job ID: j7af7f
2025-02-02 11:10:03,637 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,637 - INFO - Processing job ID: j258ec
2025-02-02 11:10:03,638 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,638 - INFO - Processing job ID: j310f7
2025-02-02 11:10:03,639 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,639 - INFO - Processing job ID: jfa37c
2025-02-02 11:10:03,640 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,640 - INFO - Processing job ID: j1fbbe
2025-02-02 11:10:03,641 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,641 - INFO - Processing job ID: j35139
2025-02-02 11:10:03,641 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,642 - INFO - Processing job ID: jb593a
2025-02-02 11:10:03,642 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,643 - INFO - Processing job ID: j537cf
2025-02-02 11:10:03,643 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,645 - INFO - Processing job ID: j53629
2025-02-02 11:10:03,645 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,645 - INFO - Processing job ID: j523af
2025-02-02 11:10:03,650 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,650 - INFO - Processing job ID: j22da7
2025-02-02 11:10:03,651 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,651 - INFO - Processing job ID: j4a946
2025-02-02 11:10:03,652 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,653 - INFO - Processing job ID: j3889f
2025-02-02 11:10:03,653 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,654 - INFO - Processing job ID: j15644
2025-02-02 11:10:03,654 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,654 - INFO - Processing job ID: j4d1b2
2025-02-02 11:10:03,655 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,655 - INFO - Processing job ID: jb3681
2025-02-02 11:10:03,655 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,656 - INFO - Processing job ID: j6c719
2025-02-02 11:10:03,656 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,656 - INFO - Processing job ID: jc126c
2025-02-02 11:10:03,657 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,657 - INFO - Processing job ID: j3eae1
2025-02-02 11:10:03,658 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,658 - INFO - Processing job ID: j8a5b6
2025-02-02 11:10:03,658 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,659 - INFO - Processing job ID: j62e39
2025-02-02 11:10:03,659 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,660 - INFO - Processing job ID: j14e04
2025-02-02 11:10:03,660 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,661 - INFO - Processing job ID: j906b1
2025-02-02 11:10:03,661 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,661 - INFO - Processing job ID: j777eb
2025-02-02 11:10:03,662 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,664 - INFO - Processing job ID: j88a0a
2025-02-02 11:10:03,665 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,666 - INFO - Processing job ID: j7bbdf
2025-02-02 11:10:03,666 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,667 - INFO - Processing job ID: j2d412
2025-02-02 11:10:03,667 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,668 - INFO - Processing job ID: je960a
2025-02-02 11:10:03,668 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,668 - INFO - Processing job ID: j3d430
2025-02-02 11:10:03,669 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,669 - INFO - Processing job ID: je32c7
2025-02-02 11:10:03,670 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,670 - INFO - Processing job ID: ja62ac
2025-02-02 11:10:03,671 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,673 - INFO - Processing job ID: j9d487
2025-02-02 11:10:03,674 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,675 - INFO - Processing job ID: jbd69b
2025-02-02 11:10:03,675 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,676 - INFO - Processing job ID: j7e506
2025-02-02 11:10:03,676 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,677 - INFO - Processing job ID: je099a
2025-02-02 11:10:03,678 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,679 - INFO - Processing job ID: jdeb7c
2025-02-02 11:10:03,680 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,681 - INFO - Processing job ID: jef5a5
2025-02-02 11:10:03,681 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,683 - INFO - Processing job ID: je55fe
2025-02-02 11:10:03,683 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,684 - INFO - Processing job ID: jd2ff3
2025-02-02 11:10:03,685 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,685 - INFO - Processing job ID: jdc467
2025-02-02 11:10:03,686 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,687 - INFO - Processing job ID: j5200a
2025-02-02 11:10:03,688 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,688 - INFO - Processing job ID: je5e1f
2025-02-02 11:10:03,690 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,690 - INFO - Processing job ID: jd04b0
2025-02-02 11:10:03,691 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,691 - INFO - Processing job ID: jbf8a5
2025-02-02 11:10:03,692 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,693 - INFO - Processing job ID: j20cfa
2025-02-02 11:10:03,693 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,695 - INFO - Processing job ID: j4ee58
2025-02-02 11:10:03,695 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,696 - INFO - Processing job ID: j3e4ab
2025-02-02 11:10:03,696 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,697 - INFO - Processing job ID: j46983
2025-02-02 11:10:03,697 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,698 - INFO - Processing job ID: j1ee25
2025-02-02 11:10:03,698 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,699 - INFO - Processing job ID: jef846
2025-02-02 11:10:03,700 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,700 - INFO - Processing job ID: j59a66
2025-02-02 11:10:03,703 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,704 - INFO - Processing job ID: jb10ca
2025-02-02 11:10:03,705 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,705 - INFO - Processing job ID: j6bee0
2025-02-02 11:10:03,706 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,707 - INFO - Processing job ID: j09678
2025-02-02 11:10:03,708 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,708 - INFO - Processing job ID: j5d37c
2025-02-02 11:10:03,709 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,709 - INFO - Processing job ID: jf8144
2025-02-02 11:10:03,710 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,710 - INFO - Processing job ID: j10c1a
2025-02-02 11:10:03,711 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,711 - INFO - Processing job ID: j56762
2025-02-02 11:10:03,712 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,712 - INFO - Processing job ID: j5115c
2025-02-02 11:10:03,713 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,713 - INFO - Processing job ID: jf7b23
2025-02-02 11:10:03,714 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,715 - INFO - Processing job ID: j948e7
2025-02-02 11:10:03,715 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,716 - INFO - Processing job ID: jb81a4
2025-02-02 11:10:03,716 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,717 - INFO - Processing job ID: j0fe47
2025-02-02 11:10:03,718 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,721 - INFO - Processing job ID: j3c25d
2025-02-02 11:10:03,721 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,722 - INFO - Processing job ID: j3a9f6
2025-02-02 11:10:03,723 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,724 - INFO - Processing job ID: jdf351
2025-02-02 11:10:03,725 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,725 - INFO - Processing job ID: j78ad0
2025-02-02 11:10:03,726 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,727 - INFO - Processing job ID: j6d7c4
2025-02-02 11:10:03,728 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,729 - INFO - Processing job ID: j8fc13
2025-02-02 11:10:03,729 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,731 - INFO - Processing job ID: j595d0
2025-02-02 11:10:03,731 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,732 - INFO - Processing job ID: je24f8
2025-02-02 11:10:03,733 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,733 - INFO - Processing job ID: j91b3d
2025-02-02 11:10:03,734 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,735 - INFO - Processing job ID: j9f466
2025-02-02 11:10:03,736 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,736 - INFO - Processing job ID: jc6209
2025-02-02 11:10:03,737 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,737 - INFO - Processing job ID: j04091
2025-02-02 11:10:03,738 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,738 - INFO - Processing job ID: jcbd72
2025-02-02 11:10:03,739 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,740 - INFO - Processing job ID: j47929
2025-02-02 11:10:03,740 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,742 - INFO - Processing job ID: j982b9
2025-02-02 11:10:03,743 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,744 - INFO - Processing job ID: j40fe4
2025-02-02 11:10:03,744 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,745 - INFO - Processing job ID: j3f682
2025-02-02 11:10:03,745 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,746 - INFO - Processing job ID: jaa44d
2025-02-02 11:10:03,746 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,747 - INFO - Processing job ID: jc0974
2025-02-02 11:10:03,747 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,748 - INFO - Processing job ID: j6ce7b
2025-02-02 11:10:03,748 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,749 - INFO - Processing job ID: jdff44
2025-02-02 11:10:03,750 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,751 - INFO - Processing job ID: jc6043
2025-02-02 11:10:03,751 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,752 - INFO - Processing job ID: j562e0
2025-02-02 11:10:03,752 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,753 - INFO - Processing job ID: jdeb9e
2025-02-02 11:10:03,753 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,754 - INFO - Processing job ID: jf00fc
2025-02-02 11:10:03,754 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,755 - INFO - Processing job ID: jea6de
2025-02-02 11:10:03,755 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,756 - INFO - Processing job ID: jfb5d1
2025-02-02 11:10:03,756 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,759 - INFO - Processing job ID: jad31a
2025-02-02 11:10:03,760 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,760 - INFO - Processing job ID: j19f63
2025-02-02 11:10:03,760 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,761 - INFO - Processing job ID: j4c6b3
2025-02-02 11:10:03,761 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,762 - INFO - Processing job ID: j0d87b
2025-02-02 11:10:03,762 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,763 - INFO - Processing job ID: j1376b
2025-02-02 11:10:03,763 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,764 - INFO - Processing job ID: j434b1
2025-02-02 11:10:03,764 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,765 - INFO - Processing job ID: jbd069
2025-02-02 11:10:03,765 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,766 - INFO - Processing job ID: jb815d
2025-02-02 11:10:03,766 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,767 - INFO - Processing job ID: j6e481
2025-02-02 11:10:03,767 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,768 - INFO - Processing job ID: j9f22f
2025-02-02 11:10:03,768 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,769 - INFO - Processing job ID: jcdccd
2025-02-02 11:10:03,769 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,770 - INFO - Processing job ID: jbf26b
2025-02-02 11:10:03,770 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,771 - INFO - Processing job ID: j9243b
2025-02-02 11:10:03,771 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,775 - INFO - Processing job ID: j7fc84
2025-02-02 11:10:03,775 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,776 - INFO - Processing job ID: j92415
2025-02-02 11:10:03,777 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,777 - INFO - Processing job ID: j9c682
2025-02-02 11:10:03,777 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,778 - INFO - Processing job ID: j6a660
2025-02-02 11:10:03,778 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,779 - INFO - Processing job ID: j3b5b4
2025-02-02 11:10:03,779 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,780 - INFO - Processing job ID: j7a1b5
2025-02-02 11:10:03,780 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,781 - INFO - Processing job ID: jaf5ce
2025-02-02 11:10:03,781 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,781 - INFO - Processing job ID: jcee43
2025-02-02 11:10:03,782 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,782 - INFO - Processing job ID: j82713
2025-02-02 11:10:03,783 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,783 - INFO - Processing job ID: ja1048
2025-02-02 11:10:03,787 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,787 - INFO - Processing job ID: j8e76a
2025-02-02 11:10:03,788 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,788 - INFO - Processing job ID: jf5378
2025-02-02 11:10:03,789 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,789 - INFO - Processing job ID: j9d67e
2025-02-02 11:10:03,789 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,790 - INFO - Processing job ID: jc3eee
2025-02-02 11:10:03,790 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,791 - INFO - Processing job ID: j62dff
2025-02-02 11:10:03,791 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,792 - INFO - Processing job ID: jb3cd2
2025-02-02 11:10:03,792 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,792 - INFO - Processing job ID: jd5538
2025-02-02 11:10:03,793 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,793 - INFO - Processing job ID: jd766e
2025-02-02 11:10:03,794 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,794 - INFO - Processing job ID: jd34e4
2025-02-02 11:10:03,794 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,795 - INFO - Processing job ID: j450f6
2025-02-02 11:10:03,795 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,796 - INFO - Processing job ID: j49c38
2025-02-02 11:10:03,796 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,797 - INFO - Processing job ID: j412f7
2025-02-02 11:10:03,797 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,801 - INFO - Processing job ID: j1e9f0
2025-02-02 11:10:03,802 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,803 - INFO - Processing job ID: j3648f
2025-02-02 11:10:03,803 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,804 - INFO - Processing job ID: j98d06
2025-02-02 11:10:03,804 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,805 - INFO - Processing job ID: j2b3b1
2025-02-02 11:10:03,806 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,806 - INFO - Processing job ID: jf11f7
2025-02-02 11:10:03,807 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,807 - INFO - Processing job ID: j150df
2025-02-02 11:10:03,807 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,808 - INFO - Processing job ID: jc5ab8
2025-02-02 11:10:03,808 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,808 - INFO - Processing job ID: jcefd3
2025-02-02 11:10:03,809 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,809 - INFO - Processing job ID: j69044
2025-02-02 11:10:03,810 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,810 - INFO - Processing job ID: j3fc98
2025-02-02 11:10:03,810 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,811 - INFO - Processing job ID: j6d232
2025-02-02 11:10:03,811 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,812 - INFO - Processing job ID: ja717e
2025-02-02 11:10:03,812 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,812 - INFO - Processing job ID: j3a75a
2025-02-02 11:10:03,813 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,813 - INFO - Processing job ID: j14fbc
2025-02-02 11:10:03,816 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,817 - INFO - Processing job ID: jbb918
2025-02-02 11:10:03,818 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,818 - INFO - Processing job ID: j3ee88
2025-02-02 11:10:03,819 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,820 - INFO - Processing job ID: j763ff
2025-02-02 11:10:03,820 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,821 - INFO - Processing job ID: ja4b4c
2025-02-02 11:10:03,821 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,821 - INFO - Processing job ID: jfa186
2025-02-02 11:10:03,822 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,822 - INFO - Processing job ID: j695d0
2025-02-02 11:10:03,823 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,823 - INFO - Processing job ID: j1557b
2025-02-02 11:10:03,823 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,824 - INFO - Processing job ID: j1f101
2025-02-02 11:10:03,826 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,826 - INFO - Processing job ID: jcb0b5
2025-02-02 11:10:03,826 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,827 - INFO - Processing job ID: j6b89a
2025-02-02 11:10:03,827 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,828 - INFO - Processing job ID: j8a54a
2025-02-02 11:10:03,828 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,828 - INFO - Processing job ID: jf9560
2025-02-02 11:10:03,829 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,829 - INFO - Processing job ID: ja0cf5
2025-02-02 11:10:03,830 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,830 - INFO - Processing job ID: j72696
2025-02-02 11:10:03,830 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,831 - INFO - Processing job ID: jf2243
2025-02-02 11:10:03,831 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,831 - INFO - Processing job ID: jd26be
2025-02-02 11:10:03,832 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,832 - INFO - Processing job ID: ja12d9
2025-02-02 11:10:03,833 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,833 - INFO - Processing job ID: j6ae8f
2025-02-02 11:10:03,836 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,836 - INFO - Processing job ID: je639d
2025-02-02 11:10:03,836 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,837 - INFO - Processing job ID: j996f5
2025-02-02 11:10:03,837 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,837 - INFO - Processing job ID: j75c6f
2025-02-02 11:10:03,838 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,838 - INFO - Processing job ID: jff24f
2025-02-02 11:10:03,839 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:03,839 - INFO - Processing job ID: jce17f
2025-02-02 11:10:03,843 - ERROR - Error extracting job details: 'responsibilities'
2025-02-02 11:10:07,770 - INFO - Saved classification for job j910b7
2025-02-02 11:10:07,771 - INFO - Classifying job 'j03a44'
2025-02-02 11:10:07,812 - INFO - Saved classification for job j542d8
2025-02-02 11:10:07,813 - INFO - Classifying job 'j445e9'
2025-02-02 11:10:07,850 - INFO - Saved classification for job j0b848
2025-02-02 11:10:07,851 - INFO - Classifying job 'j1a69d'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Processing complete:
- New jobs processed: 402
- Skipped jobs (already processed): 750</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2025-02-02 11:10:19,428 - INFO - Saved classification for job j445e9
2025-02-02 11:10:19,428 - INFO - Classifying job 'jad973'
2025-02-02 11:10:20,631 - INFO - Saved classification for job j1a69d
2025-02-02 11:10:20,631 - INFO - Classifying job 'j13a46'
2025-02-02 11:10:21,584 - INFO - Saved classification for job j03a44
2025-02-02 11:10:21,587 - INFO - Classifying job 'j65e37'
2025-02-02 11:10:36,111 - INFO - Saved classification for job j65e37
2025-02-02 11:10:36,111 - INFO - Classifying job 'j4b5d3'
2025-02-02 11:10:37,453 - INFO - Saved classification for job j13a46
2025-02-02 11:10:37,455 - INFO - Classifying job 'jf88d5'
2025-02-02 11:10:52,510 - INFO - Saved classification for job jf88d5
2025-02-02 11:10:52,511 - INFO - Classifying job 'j9bed6'
2025-02-02 11:10:53,698 - INFO - Saved classification for job j4b5d3
2025-02-02 11:10:53,699 - INFO - Classifying job 'j37544'
2025-02-02 11:10:57,238 - INFO - Saved classification for job jad973
2025-02-02 11:10:57,239 - INFO - Classifying job 'j5fc51'
2025-02-02 11:11:06,329 - INFO - Saved classification for job j9bed6
2025-02-02 11:11:06,329 - INFO - Classifying job 'jc9f2e'
2025-02-02 11:11:07,583 - INFO - Saved classification for job j37544
2025-02-02 11:11:07,584 - INFO - Classifying job 'j022db'
2025-02-02 11:11:08,570 - INFO - Saved classification for job j5fc51
2025-02-02 11:11:08,570 - INFO - Classifying job 'j8c176'
2025-02-02 11:11:19,684 - INFO - Saved classification for job jc9f2e
2025-02-02 11:11:19,685 - INFO - Classifying job 'j14012'
2025-02-02 11:11:21,624 - INFO - Saved classification for job j022db
2025-02-02 11:11:21,624 - INFO - Classifying job 'j7b0af'
2025-02-02 11:11:24,198 - INFO - Saved classification for job j8c176
2025-02-02 11:11:24,199 - INFO - Classifying job 'j70e10'
2025-02-02 11:11:31,049 - INFO - Saved classification for job j7b0af
2025-02-02 11:11:31,049 - INFO - Classifying job 'j04898'
2025-02-02 11:11:36,686 - INFO - Saved classification for job j14012
2025-02-02 11:11:36,687 - INFO - Classifying job 'j220d9'
2025-02-02 11:11:40,058 - INFO - Saved classification for job j70e10
2025-02-02 11:11:40,059 - INFO - Classifying job 'jd31c6'
2025-02-02 11:11:43,576 - INFO - Saved classification for job j04898
2025-02-02 11:11:43,578 - INFO - Classifying job 'j8f1d4'
2025-02-02 11:11:52,052 - INFO - Saved classification for job j220d9
2025-02-02 11:11:52,052 - INFO - Classifying job 'j3174e'
2025-02-02 11:11:55,013 - INFO - Saved classification for job j8f1d4
2025-02-02 11:11:55,014 - INFO - Classifying job 'j99c64'
2025-02-02 11:11:58,609 - INFO - Saved classification for job jd31c6
2025-02-02 11:11:58,610 - INFO - Classifying job 'jf16d4'
2025-02-02 11:12:05,280 - INFO - Saved classification for job j3174e
2025-02-02 11:12:05,280 - INFO - Classifying job 'j6505d'
2025-02-02 11:12:06,232 - INFO - Saved classification for job j99c64
2025-02-02 11:12:06,233 - INFO - Classifying job 'jd6b14'
2025-02-02 11:12:12,121 - INFO - Saved classification for job jf16d4
2025-02-02 11:12:12,121 - INFO - Classifying job 'jef120'
2025-02-02 11:12:18,541 - INFO - Saved classification for job j6505d
2025-02-02 11:12:18,542 - INFO - Classifying job 'j3eca8'
2025-02-02 11:12:20,232 - INFO - Saved classification for job jd6b14
2025-02-02 11:12:20,234 - INFO - Classifying job 'j16a45'
2025-02-02 11:12:23,524 - INFO - Saved classification for job jef120
2025-02-02 11:12:23,524 - INFO - Classifying job 'j8ab08'
2025-02-02 11:12:30,380 - INFO - Saved classification for job j3eca8
2025-02-02 11:12:30,380 - INFO - Classifying job 'j39805'
2025-02-02 11:12:30,569 - INFO - Saved classification for job j16a45
2025-02-02 11:12:30,570 - INFO - Classifying job 'j3b1b4'
2025-02-02 11:12:35,286 - INFO - Saved classification for job j8ab08
2025-02-02 11:12:41,424 - INFO - Saved classification for job j3b1b4
2025-02-02 11:12:45,197 - INFO - Saved classification for job j39805
2025-02-02 11:12:45,198 - INFO - Job classification complete</code></pre>
</div>
</div>
</section>
</section>
<section id="load-final-data" class="level1">
<h1>Load final data</h1>
<p>Now I’ll load and combine all of the different data outputs into a single dataframe.</p>
<p>The code block below uses a DataLoader class with helper classes DataPaths and SalaryProcessor to handle the data processing pipeline. The code merges job posting data with role classifications, processes salary information by converting CAD to USD and extracting salary ranges, and filters the results to only include the four specific AI-related roles of interest: AI Research Scientist, AI Solution Architect, AI/ML Engineer, and MLOps/AI Infrastructure Engineer. The code includes error handling for JSON file loading and salary processing. The final output is a pandas DataFrame containing the merged and processed data, which includes job details, role classifications, and standardized salary information.</p>
<div id="0398b4b0" class="cell" data-code-fold-show="false" data-execution_count="10">
<details class="code-fold">
<summary>Click to view the code for loading and merging all data sources</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Optional, Dict</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataPaths:</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Configuration for data file paths"""</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    ROLE_CLASSIFICATIONS_DIR: Path <span class="op">=</span> Path(<span class="st">'role_classifications'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    JSON_DATA_DIR: Path <span class="op">=</span> Path(<span class="st">'json_data'</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataLoader:</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, paths: DataPaths <span class="op">=</span> DataPaths()):</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.paths <span class="op">=</span> paths</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.salary_processor <span class="op">=</span> SalaryProcessor()</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_and_merge_data(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load and merge all data sources"""</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load and merge base data</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        merged_df <span class="op">=</span> <span class="va">self</span>._load_base_data()</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process salaries</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        salary_data <span class="op">=</span> <span class="va">self</span>.salary_processor.extract_salary_ranges(merged_df[<span class="st">'salary'</span>])</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        merged_df <span class="op">=</span> pd.concat([merged_df, salary_data], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter out any jobs not in this list</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        merged_df <span class="op">=</span> merged_df[merged_df[<span class="st">'role_title'</span>].isin(</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>            [<span class="st">'AI Research Scientist'</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'AI Solution Architect'</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'AI/ML Engineer'</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'MLOps / AI Infrastructure Engineer'</span>]</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>        )]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Shape of merged DataFrame: </span><span class="sc">{</span>merged_df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> merged_df</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _load_base_data(<span class="va">self</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load and merge base data sources"""</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load role classifications</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>        role_data <span class="op">=</span> pd.DataFrame(<span class="va">self</span>._load_json_files(<span class="va">self</span>.paths.ROLE_CLASSIFICATIONS_DIR))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load and process jobs data</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>        jobs_data <span class="op">=</span> pd.DataFrame(<span class="va">self</span>._load_json_files(<span class="va">self</span>.paths.JSON_DATA_DIR))</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>        jobs_data[<span class="st">'filename'</span>] <span class="op">=</span> jobs_data[<span class="st">'url'</span>].<span class="bu">apply</span>(</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>            <span class="kw">lambda</span> x: <span class="ss">f"j</span><span class="sc">{</span>hashlib<span class="sc">.</span>md5(x.encode())<span class="sc">.</span>hexdigest()[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Merge dataframes</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>        merged_df <span class="op">=</span> pd.merge(jobs_data, role_data, on<span class="op">=</span><span class="st">'filename'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> merged_df</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _load_json_files(<span class="va">self</span>, directory: Path) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Load JSON files from directory"""</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>        json_files <span class="op">=</span> []</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> file_path <span class="kw">in</span> directory.glob(<span class="st">'*.json'</span>):</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>                    json_files.append(json.load(f))</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Error reading </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> json_files</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalaryProcessor:</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles salary-related processing"""</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    CAD_TO_USD_RATE <span class="op">=</span> <span class="fl">1.44</span>  <span class="co"># 1 USD = 1.44 CAD</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_salary_ranges(<span class="va">self</span>, salary_series: pd.Series) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract salary ranges from a series of salary strings"""</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>        salary_data <span class="op">=</span> salary_series.<span class="bu">apply</span>(<span class="va">self</span>._extract_salary_range)</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame({</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">'min_salary'</span>: salary_data.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>]),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">'max_salary'</span>: salary_data.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">1</span>]),</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mid_salary'</span>: salary_data.<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x[<span class="dv">0</span>] <span class="op">+</span> x[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span> <span class="cf">if</span> x[<span class="dv">0</span>] <span class="kw">and</span> x[<span class="dv">1</span>] <span class="cf">else</span> <span class="va">None</span>)</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _extract_salary_range(<span class="va">self</span>, salary_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Optional[<span class="bu">float</span>], Optional[<span class="bu">float</span>]]:</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extract minimum and maximum salary from salary string"""</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(salary_str, <span class="bu">str</span>) <span class="kw">or</span> <span class="st">'0+'</span> <span class="kw">in</span> salary_str:</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">None</span>, <span class="va">None</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Determine currency and convert if needed</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>            is_cad <span class="op">=</span> <span class="st">'CAD'</span> <span class="kw">in</span> salary_str</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>            nums <span class="op">=</span> (salary_str.replace(<span class="st">'CAD '</span>, <span class="st">''</span>)</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>                            .replace(<span class="st">'USD '</span>, <span class="st">''</span>)</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>                            .replace(<span class="st">'K'</span>, <span class="st">''</span>)</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>                            .split(<span class="st">' - '</span>))</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(nums) <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">None</span>, <span class="va">None</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert to float and apply CAD conversion if needed</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>            min_salary <span class="op">=</span> <span class="bu">float</span>(nums[<span class="dv">0</span>])</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>            max_salary <span class="op">=</span> <span class="bu">float</span>(nums[<span class="dv">1</span>])</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> is_cad:</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>                min_salary <span class="op">*=</span> <span class="va">self</span>.CAD_TO_USD_RATE</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>                max_salary <span class="op">*=</span> <span class="va">self</span>.CAD_TO_USD_RATE</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> min_salary, max_salary</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span>, <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="04715338" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the loader and load the data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the csv file exists</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="st">'genai_job_data.csv'</span>):</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    loader <span class="op">=</span> DataLoader()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> loader.load_and_merge_data()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    df.to_csv(<span class="st">'genai_job_data.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(<span class="st">'genai_job_data.csv'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now df contains all the merged data with processed salaries</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total jobs loaded: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example operations you can do with the DataFrame:</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># View available columns</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Available columns:"</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns.tolist())</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View distribution of roles</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Role distribution:"</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'role_title'</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total jobs loaded: 187

Available columns:
['title', 'company', 'location', 'level', 'salary', 'url', 'description', 'scraped_date', 'posted_date', 'raw_data', 'filename', 'responsibilities', 'skills', 'analysis', 'role_classification', 'role_title', 'min_salary', 'max_salary', 'mid_salary']

Role distribution:
role_title
AI/ML Engineer                        60
AI Research Scientist                 52
AI Solution Architect                 48
MLOps / AI Infrastructure Engineer    27
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="salary-analysis" class="level1">
<h1>Salary analysis</h1>
<p>First I’ll analyze the salary data for each role and experience level. I’ll use a RandomForest model to adjust for location differences, and convert any CAD denominated salaries to USD. I’m interested to see what compensation is like for each role, and if there are any significant differences in compensation between the roles.</p>
<p>The code below implements a salary analysis system for the job posting data. It processes salary information across different roles and experience levels, handling currency conversions (CAD to USD) and adjusting for location differences using a RandomForest model. For each role and level combination, it calculates salary ranges, removes statistical outliers, and provides sample sizes. The system includes configuration settings for analysis parameters and comprehensive error handling. The code uses pandas for data manipulation and scikit-learn for the location adjustment model, with results formatted as salary ranges in USD.</p>
<div id="4c2d38e9" class="cell" data-code-fold-show="false" data-execution_count="12">
<details class="code-fold">
<summary>Click to view the code for salary analysis</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Optional, TypedDict, Set</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalaryConfig:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Configuration settings for salary analysis"""</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    outlier_threshold: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    n_estimators: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    min_group_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    currency_symbol: <span class="bu">str</span> <span class="op">=</span> <span class="st">'$'</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    cv_folds: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalaryColumns(TypedDict):</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Type definitions for salary DataFrame columns"""</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    min_salary_usd_k: <span class="bu">float</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    max_salary_usd_k: <span class="bu">float</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    median_salary_usd_k: <span class="bu">float</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    sample_size: <span class="bu">int</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    location_adjusted_zscore: <span class="bu">float</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalaryAnalyzer:</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Analyzes salary distributions across role titles.</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">    Column Naming Conventions:</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">    - *_usd_k: Values in thousands of USD</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">    - *_zscore: Standardized scores (mean=0, std=1)</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">    - sample_size: Number of data points in group</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">    - *_median: Median values</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">    - location_adjusted_*: Values adjusted for location differences</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes:</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="co">        config: Configuration settings for analysis</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co">        logger: Logger instance for the class</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Input column names</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    COL_MIN_SALARY <span class="op">=</span> <span class="st">'min_salary'</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    COL_MAX_SALARY <span class="op">=</span> <span class="st">'max_salary'</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    COL_ROLE_TITLE <span class="op">=</span> <span class="st">'role_title'</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    COL_LEVEL <span class="op">=</span> <span class="st">'level'</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    COL_LOCATION <span class="op">=</span> <span class="st">'location'</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Processed column names</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    COL_MEDIAN_SALARY <span class="op">=</span> <span class="st">'median_salary_usd_k'</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    COL_MIN_SALARY_MEDIAN <span class="op">=</span> <span class="st">'min_salary_median_usd_k'</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    COL_MAX_SALARY_MEDIAN <span class="op">=</span> <span class="st">'max_salary_median_usd_k'</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    COL_SAMPLE_SIZE <span class="op">=</span> <span class="st">'sample_size'</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Z-score columns</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    COL_MIN_ZSCORE <span class="op">=</span> <span class="st">'min_salary_location_adjusted_zscore'</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    COL_MID_ZSCORE <span class="op">=</span> <span class="st">'median_salary_location_adjusted_zscore'</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    COL_MAX_ZSCORE <span class="op">=</span> <span class="st">'max_salary_location_adjusted_zscore'</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config: Optional[SalaryConfig] <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Initialize SalaryAnalyzer with optional configuration."""</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> config <span class="kw">or</span> SalaryConfig()</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._model <span class="op">=</span> <span class="va">None</span>  <span class="co"># Cache for trained model</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_role_salaries(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a><span class="co">        Analyze salary distributions across role titles with location adjustment.</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="co">            df: DataFrame containing columns:</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="co">                - min_salary: Minimum salary (float)</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a><span class="co">                - max_salary: Maximum salary (float)</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="co">                - role_title: Job role (str)</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="co">                - level: Experience level (str)</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="co">                - location: Job location (str)</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="co">                </span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="co">            DataFrame with aggregated salary statistics by role and level</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="co">            </span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="co">        Raises:</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="co">            ValueError: If required columns are missing or DataFrame is empty</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._validate_input(df)</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"Starting salary analysis with </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss"> records"</span>)</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create working copy of DataFrame</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>        analysis_df <span class="op">=</span> <span class="va">self</span>._prepare_data(df)</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process and clean data</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>        analysis_df <span class="op">=</span> <span class="va">self</span>._process_data(analysis_df)</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate final results</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>._aggregate_results(analysis_df)</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"Salary analysis completed successfully"</span>)</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _validate_input(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Validate input DataFrame."""</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> df.empty:</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Input DataFrame cannot be None or empty"</span>)</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>        required_cols <span class="op">=</span> {</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MIN_SALARY, </span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MAX_SALARY, </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_ROLE_TITLE,</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_LEVEL,</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_LOCATION</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>        missing_cols <span class="op">=</span> required_cols <span class="op">-</span> <span class="bu">set</span>(df.columns)</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing_cols:</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"DataFrame missing required columns: </span><span class="sc">{</span>missing_cols<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _prepare_data(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Prepare data for analysis by filtering valid salaries."""</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>        valid_salary_mask <span class="op">=</span> (</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>            df[<span class="va">self</span>.COL_MIN_SALARY].notna() <span class="op">&amp;</span> </span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>            df[<span class="va">self</span>.COL_MAX_SALARY].notna()</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_salary_mask.<span class="bu">any</span>():</span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.warning(<span class="st">"No valid salary data found"</span>)</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create working copy and calculate median salary</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>        analysis_df <span class="op">=</span> df[valid_salary_mask].copy()</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>        analysis_df[<span class="va">self</span>.COL_MEDIAN_SALARY] <span class="op">=</span> (</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>            analysis_df[[<span class="va">self</span>.COL_MIN_SALARY, <span class="va">self</span>.COL_MAX_SALARY]].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> analysis_df</span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _remove_outliers(<span class="va">self</span>, group: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Remove statistical outliers from salary data."""</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&lt;=</span> <span class="va">self</span>.config.min_group_size:</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> group</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Only check min and max salary for outliers</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>        salary_cols <span class="op">=</span> [<span class="va">self</span>.COL_MIN_SALARY, <span class="va">self</span>.COL_MAX_SALARY]</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> salary_cols:</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>            Q1 <span class="op">=</span> group[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>            Q3 <span class="op">=</span> group[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>            IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>            outlier_mask <span class="op">=</span> <span class="op">~</span>(</span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>                (group[col] <span class="op">&lt;</span> (Q1 <span class="op">-</span> <span class="va">self</span>.config.outlier_threshold <span class="op">*</span> IQR)) <span class="op">|</span> </span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>                (group[col] <span class="op">&gt;</span> (Q3 <span class="op">+</span> <span class="va">self</span>.config.outlier_threshold <span class="op">*</span> IQR))</span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>            group <span class="op">=</span> group[outlier_mask]</span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Recalculate median after removing outliers</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>        group[<span class="va">self</span>.COL_MEDIAN_SALARY] <span class="op">=</span> (</span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>            group[<span class="va">self</span>.COL_MIN_SALARY] <span class="op">+</span> group[<span class="va">self</span>.COL_MAX_SALARY]</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> group</span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _aggregate_results(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Aggregate and format the final results."""</span></span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>        <span class="co"># First calculate group statistics</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>        grouped <span class="op">=</span> df.groupby([<span class="va">self</span>.COL_ROLE_TITLE, <span class="va">self</span>.COL_LEVEL]).agg({</span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MIN_SALARY: [<span class="st">'count'</span>, <span class="st">'median'</span>],</span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MAX_SALARY: <span class="st">'median'</span>,</span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate median salary from min and max medians</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>        grouped[<span class="st">'median_salary'</span>] <span class="op">=</span> (</span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>            grouped[(<span class="va">self</span>.COL_MIN_SALARY, <span class="st">'median'</span>)] <span class="op">+</span> </span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>            grouped[(<span class="va">self</span>.COL_MAX_SALARY, <span class="st">'median'</span>)]</span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flatten and rename columns</span></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>        grouped.columns <span class="op">=</span> [</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>            <span class="st">'sample_size'</span> <span class="cf">if</span> col <span class="op">==</span> (<span class="va">self</span>.COL_MIN_SALARY, <span class="st">'count'</span>)</span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="st">'min_salary_usd_k'</span> <span class="cf">if</span> col <span class="op">==</span> (<span class="va">self</span>.COL_MIN_SALARY, <span class="st">'median'</span>)</span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="st">'max_salary_usd_k'</span> <span class="cf">if</span> col <span class="op">==</span> (<span class="va">self</span>.COL_MAX_SALARY, <span class="st">'median'</span>)</span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="st">'median_salary_usd_k'</span> <span class="cf">if</span> col[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'median_salary'</span></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> col</span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> grouped.columns</span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Order columns</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a>        ordered_cols <span class="op">=</span> [</span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a>            <span class="st">'sample_size'</span>,</span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>            <span class="st">'min_salary_usd_k'</span>,</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">'max_salary_usd_k'</span>,</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a>            <span class="st">'median_salary_usd_k'</span></span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> grouped.reindex(columns<span class="op">=</span>ordered_cols)</span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Format salary values</span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a>        salary_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> ordered_cols <span class="cf">if</span> col.endswith(<span class="st">'_usd_k'</span>)]</span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> salary_cols:</span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a>            result[col] <span class="op">=</span> result[col].<span class="bu">apply</span>(</span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config<span class="sc">.</span>currency_symbol<span class="sc">}{</span>x<span class="sc">:,.0f}</span><span class="ss">K"</span> <span class="cf">if</span> pd.notna(x) <span class="cf">else</span> <span class="st">"N/A"</span></span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _process_data(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Process and clean the salary data."""</span></span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove outliers by group</span></span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> (df.groupby([<span class="va">self</span>.COL_ROLE_TITLE, <span class="va">self</span>.COL_LEVEL])</span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>              .<span class="bu">apply</span>(<span class="va">self</span>._remove_outliers)</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a>              .reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add location-adjusted scores</span></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>._add_location_adjusted_scores(df)</span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean level names</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a>        df[<span class="va">self</span>.COL_LEVEL] <span class="op">=</span> (df[<span class="va">self</span>.COL_LEVEL]</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>                             .<span class="bu">str</span>.replace(<span class="st">'-Level / Level'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>                             .<span class="bu">str</span>.replace(<span class="st">'-level'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _train_model(<span class="va">self</span>) <span class="op">-&gt;</span> RandomForestRegressor:</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Train and cache RandomForest model."""</span></span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>._model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._model <span class="op">=</span> RandomForestRegressor(</span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a>                n_estimators<span class="op">=</span><span class="va">self</span>.config.n_estimators,</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>                random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._model</span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _add_location_adjusted_scores(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Add location-adjusted z-scores to the dataframe."""</span></span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a>        location_dummies <span class="op">=</span> pd.get_dummies(df[<span class="va">self</span>.COL_LOCATION], prefix<span class="op">=</span><span class="st">'loc'</span>)</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>._train_model()</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a>        score_columns <span class="op">=</span> {</span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MIN_SALARY: <span class="va">self</span>.COL_MIN_ZSCORE,</span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MEDIAN_SALARY: <span class="va">self</span>.COL_MID_ZSCORE,</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.COL_MAX_SALARY: <span class="va">self</span>.COL_MAX_ZSCORE</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_col, target_col <span class="kw">in</span> score_columns.items():</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a>            df[target_col] <span class="op">=</span> <span class="va">self</span>._adjust_salaries(</span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>                df[source_col], </span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a>                location_dummies,</span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a>                model</span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _adjust_salaries(<span class="va">self</span>, </span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a>                        salary_series: pd.Series,</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a>                        X: pd.DataFrame,</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a>                        model: RandomForestRegressor) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Adjust salaries using RandomForest model."""</span></span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate model performance</span></span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a>        scores <span class="op">=</span> cross_val_score(</span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a>            model, X, salary_series, </span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a>            cv<span class="op">=</span><span class="va">self</span>.config.cv_folds</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.debug(<span class="ss">f"Cross-validation scores: </span><span class="sc">{</span>scores<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> ± </span><span class="sc">{</span>scores<span class="sc">.</span>std()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fit model and calculate residuals</span></span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a>        model.fit(X, salary_series)</span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a>        expected <span class="op">=</span> model.predict(X)</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a>        residuals <span class="op">=</span> salary_series <span class="op">-</span> expected</span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return standardized residuals</span></span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (residuals <span class="op">-</span> residuals.mean()) <span class="op">/</span> residuals.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="80e8ef1a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>salary_analyzer <span class="op">=</span> SalaryAnalyzer()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>salary_df <span class="op">=</span> salary_analyzer.analyze_role_salaries(df)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>salary_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2025-02-02 11:12:45,577 - INFO - Starting salary analysis with 187 records
2025-02-02 11:12:48,115 - INFO - Salary analysis completed successfully</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sample_size</th>
<th data-quarto-table-cell-role="th">min_salary_usd_k</th>
<th data-quarto-table-cell-role="th">max_salary_usd_k</th>
<th data-quarto-table-cell-role="th">median_salary_usd_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">role_title</th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">AI Research Scientist</td>
<td data-quarto-table-cell-role="th">Entry</td>
<td>3</td>
<td>$140K</td>
<td>$170K</td>
<td>$155K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Mid</td>
<td>8</td>
<td>$122K</td>
<td>$209K</td>
<td>$166K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Senior</td>
<td>24</td>
<td>$159K</td>
<td>$251K</td>
<td>$205K</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">AI Solution Architect</td>
<td data-quarto-table-cell-role="th">Entry</td>
<td>2</td>
<td>$133K</td>
<td>$266K</td>
<td>$200K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Mid</td>
<td>7</td>
<td>$120K</td>
<td>$206K</td>
<td>$163K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Senior</td>
<td>33</td>
<td>$146K</td>
<td>$247K</td>
<td>$196K</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">AI/ML Engineer</td>
<td data-quarto-table-cell-role="th">Entry</td>
<td>1</td>
<td>$135K</td>
<td>$251K</td>
<td>$193K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Mid</td>
<td>11</td>
<td>$129K</td>
<td>$224K</td>
<td>$176K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Senior</td>
<td>28</td>
<td>$158K</td>
<td>$268K</td>
<td>$213K</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">MLOps / AI Infrastructure Engineer</td>
<td data-quarto-table-cell-role="th">Entry</td>
<td>2</td>
<td>$152K</td>
<td>$260K</td>
<td>$206K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Mid</td>
<td>5</td>
<td>$143K</td>
<td>$214K</td>
<td>$178K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Senior</td>
<td>16</td>
<td>$164K</td>
<td>$258K</td>
<td>$211K</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Looking across all the four GenAI roles (AI Research, Solutions Architecture, ML Engineering, and MLOps), compensation bands are similar. At senior levels (where I have the largest samples), median salaries cluster tightly between ~$195K-$210K USD. Mid-level positions show medians between ~$165K-$180K USD, and entry-level positions generally start between ~$155K-$205K USD, although this entry-level data is limited by small samples.</p>
<p>This consistency suggests these roles are valued similarly in the market, despite their different focuses.</p>
</section>
<section id="job-responsibilities" class="level1">
<h1>Job responsibilities</h1>
<p>Next, I’m interested to see what the job responsibilities are for some of these roles, and how they differ. I’ll use an LLM to identify the most common responsibilities and skills for a given role. This task will be quite complex, involving a lot of input data. So a model like <code>o1</code> will be more appropriate. I don’t have access to <code>o1</code> via API, so I’ll use the web interface to generate completions, and prepare XML files for the inputs to this task – allowing me to copy-paste the XML into the chat.</p>
<p>As we’ll see, Research Scientists lean heavily into discovery, theoretical advances, publication, and cutting-edge experimentation, whereas ML Engineers center on production-grade systems, robust architecture, MLOps, and aligning with business needs. Although in many cases, the lines between these roles will be blurred.</p>
<div id="9e41cca9" class="cell" data-code-fold-show="false" data-execution_count="14">
<details class="code-fold">
<summary>Click to view the code for XML generation</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>INSTRUCTION_PREFIX <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">Identify the most common Responsibilities and Skills listed in the jobs below, returning a bulleted list in the format</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Responsibilities</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">- [responsibility]: [responsibility description]</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="st">- [responsibility]: [responsibility description]</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">...</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st"># Skills</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">- [skill]: [skill description]</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="st">- [skill]: [skill description]</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="st">...</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> XMLGenerator:</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Handles generation of XML files from job data"""</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">'xml_roles'</span>):</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        os.makedirs(output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>logging.INFO,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> compile_xml_for_role(<span class="va">self</span>, level: <span class="bu">str</span>, role_title: <span class="bu">str</span>, df: pd.DataFrame) <span class="op">-&gt;</span> Dict:</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate XML-formatted string of job details for the given level and role title."""</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter DataFrame for matching level and role</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        filtered_df <span class="op">=</span> df[</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>            (df[<span class="st">'level'</span>] <span class="op">==</span> level) <span class="op">&amp;</span> </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>            (df[<span class="st">'role_title'</span>] <span class="op">==</span> role_title)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(filtered_df) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'level'</span>: level,</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">'role_title'</span>: role_title,</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'xml_output'</span>: <span class="st">''</span>,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">'error'</span>: <span class="ss">f"No jobs found for </span><span class="sc">{</span>level<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role_title<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Build XML string</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>        xml_output <span class="op">=</span> <span class="st">""</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, job <span class="kw">in</span> filtered_df.iterrows():</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>            xml_output <span class="op">+=</span> <span class="st">"&lt;Job&gt;</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>            xml_output <span class="op">+=</span> <span class="ss">f"&lt;Responsibilities&gt;</span><span class="sc">{</span>job[<span class="st">'responsibilities'</span>]<span class="sc">}</span><span class="ss">&lt;/Responsibilities&gt;</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>            xml_output <span class="op">+=</span> <span class="ss">f"&lt;Skills&gt;</span><span class="sc">{</span>job[<span class="st">'skills'</span>]<span class="sc">}</span><span class="ss">&lt;/Skills&gt;</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>            xml_output <span class="op">+=</span> <span class="st">"&lt;/Job&gt;</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">'level'</span>: level,</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">'role_title'</span>: role_title,</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">'xml_output'</span>: INSTRUCTION_PREFIX <span class="op">+</span> xml_output</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_xml(<span class="va">self</span>, level: <span class="bu">str</span>, role_title: <span class="bu">str</span>, xml_data: Dict) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Save XML data to a file"""</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> xml_data[<span class="st">'xml_output'</span>]:</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>            <span class="co">#logging.warning(xml_data.get('error', 'Empty XML output'))</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean and sanitize the filename components</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>        cleaned_level <span class="op">=</span> level.replace(<span class="st">'-Level / Level'</span>, <span class="st">''</span>).strip()</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>        safe_level <span class="op">=</span> cleaned_level.replace(<span class="st">'/'</span>, <span class="st">'_'</span>).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        safe_role <span class="op">=</span> role_title.replace(<span class="st">'/'</span>, <span class="st">'_'</span>).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> os.path.join(<span class="va">self</span>.output_dir, <span class="ss">f"</span><span class="sc">{</span>safe_level<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_role<span class="sc">}</span><span class="ss">.xml"</span>)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>            f.write(xml_data[<span class="st">'xml_output'</span>])</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>        logging.debug(<span class="ss">f"Saved XML for </span><span class="sc">{</span>cleaned_level<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role_title<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_all_xml(<span class="va">self</span>, df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate XML files for all role/level combinations"""</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>            logging.warning(<span class="st">"No jobs found in DataFrame - check if data was loaded correctly"</span>)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>        required_cols <span class="op">=</span> [<span class="st">'level'</span>, <span class="st">'role_title'</span>, <span class="st">'responsibilities'</span>, <span class="st">'skills'</span>]  <span class="co"># Changed here too</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">all</span>(col <span class="kw">in</span> df.columns <span class="cf">for</span> col <span class="kw">in</span> required_cols):</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f"DataFrame missing required columns: </span><span class="sc">{</span>required_cols<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process each unique role/level combination</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>        role_combinations <span class="op">=</span> df[[<span class="st">'level'</span>, <span class="st">'role_title'</span>]].drop_duplicates()</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, combo <span class="kw">in</span> role_combinations.iterrows():</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>            xml_data <span class="op">=</span> <span class="va">self</span>.compile_xml_for_role(</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>                combo[<span class="st">'level'</span>], </span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>                combo[<span class="st">'role_title'</span>], </span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>                df</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.save_xml(combo[<span class="st">'level'</span>], combo[<span class="st">'role_title'</span>], xml_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e7c06794" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>xml_generator <span class="op">=</span> XMLGenerator()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>xml_generator.generate_all_xml(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="o1-generated-senior-ai-research-scientist" class="level2">
<h2 class="anchored" data-anchor-id="o1-generated-senior-ai-research-scientist">o1-generated Senior AI Research Scientist</h2>
<p>Here’s what <code>o1</code> said about the Responsibilities and Skills observed in Senior AI Research Scientist roles:</p>
<section id="responsibilities" class="level3">
<h3 class="anchored" data-anchor-id="responsibilities">Responsibilities</h3>
<ul>
<li><p><strong>Conduct advanced AI research</strong><br>
Many roles require pushing the state-of-the-art in Generative AI, LLMs, and related areas (e.g., video/multimodal models, diffusion models) through novel algorithms, architectures, and experimental studies.</p></li>
<li><p><strong>Train and fine-tune large-scale models</strong><br>
Commonly involves working with massive datasets and distributed training setups (thousands of GPUs, HPC environments) to develop foundation models and advanced AI systems.</p></li>
<li><p><strong>Develop and implement new algorithms or architectures</strong><br>
Spans designing novel model architectures (e.g., diffusion, transformer-based, multimodal fusion) and creating robust data processing or simulation pipelines to support AI solutions.</p></li>
<li><p><strong>Collaborate with cross-functional teams</strong><br>
Emphasizes close work with engineering, product management, research, and external stakeholders to integrate AI breakthroughs into real-world applications and products.</p></li>
<li><p><strong>Evaluate and measure AI performance</strong><br>
Entails building rigorous evaluation frameworks, designing new metrics, and systematically analyzing model behavior to ensure quality and reliability.</p></li>
<li><p><strong>Publish and communicate research findings</strong><br>
Many positions highlight writing influential papers, presenting at conferences, and sharing innovative results both internally and with the broader AI community.</p></li>
<li><p><strong>Build and maintain data pipelines</strong><br>
Involves constructing high-quality, scalable data pipelines or tooling to support training, fine-tuning, and inference of large models.</p></li>
<li><p><strong>Ensure production-grade implementation</strong><br>
Requires writing clean, efficient, and maintainable code as well as optimizing models and pipelines to meet performance, reliability, and quality standards.</p></li>
</ul>
</section>
<section id="skills" class="level3">
<h3 class="anchored" data-anchor-id="skills">Skills</h3>
<ul>
<li><p><strong>Proficiency in Python and deep learning frameworks</strong><br>
Strong coding skills in Python and hands-on experience with libraries such as PyTorch, TensorFlow, or JAX appear in nearly every role.</p></li>
<li><p><strong>Expertise with LLMs and Generative AI</strong><br>
Deep understanding of transformer architectures, diffusion models, multimodal systems, prompt engineering, and other advanced AI techniques is frequently mentioned.</p></li>
<li><p><strong>Experience with large-scale/distributed training</strong><br>
Many roles emphasize knowledge of HPC, GPU optimization, model parallelism (e.g., FSDP, DeepSpeed, Megatron-LM), and handling massive datasets.</p></li>
<li><p><strong>Strong software engineering practices</strong><br>
Testing, code review, debugging, version control, and producing clean, modular research or production code are consistently important.</p></li>
<li><p><strong>Collaboration and communication skills</strong><br>
Clear written and verbal communication, along with cross-functional teamwork, is vital for integrating AI solutions into products and relaying complex ideas.</p></li>
<li><p><strong>Research acumen and adaptability</strong><br>
Ability to read, interpret, and prototype cutting-edge AI literature, publish findings, and rapidly iterate on experiments.</p></li>
<li><p><strong>Machine Learning fundamentals</strong><br>
Solid grounding in ML theory (e.g., optimization, statistics, data structures) and experience with model evaluation, data manipulation, and pipeline design.</p></li>
<li><p><strong>Familiarity with prompt engineering and advanced NLP concepts</strong><br>
Many roles highlight crafting effective prompts, aligning model outputs with user needs, and leveraging text-generation or conversational AI techniques.</p></li>
</ul>
</section>
</section>
<section id="o1-generated-senior-ai-ml-engineer" class="level2">
<h2 class="anchored" data-anchor-id="o1-generated-senior-ai-ml-engineer">o1-generated Senior AI ML Engineer</h2>
<p>And here’s what <code>o1</code> said about the Responsibilities and Skills observed in Senior AI ML Engineer roles:</p>
<section id="responsibilities-1" class="level3">
<h3 class="anchored" data-anchor-id="responsibilities-1">Responsibilities</h3>
<ul>
<li><p><strong>Design, develop, and deploy AI/ML solutions</strong><br>
End-to-end creation of machine learning systems, from initial prototypes to production-ready deployments.</p></li>
<li><p><strong>Collaborate with cross-functional teams</strong><br>
Work closely with product managers, data scientists, engineers, and other stakeholders to align technical solutions with business goals.</p></li>
<li><p><strong>Monitor and optimize model performance</strong><br>
Track key metrics, fine-tune models, and iterate to ensure continuous improvement and reliability in production.</p></li>
<li><p><strong>Stay current with AI research and emerging technologies</strong><br>
Keep up-to-date with the latest breakthroughs in areas like LLMs, generative AI, and deep learning.</p></li>
<li><p><strong>Mentor and coach team members</strong><br>
Provide guidance on best practices, design patterns, code quality, and career development for junior or peer engineers.</p></li>
<li><p><strong>Develop scalable data/ML pipelines</strong><br>
Build robust infrastructure for data collection, preprocessing, model training, and deployment at scale.</p></li>
<li><p><strong>Implement and maintain CI/CD and coding best practices</strong><br>
Ensure code quality, streamline release processes, and enforce testing discipline for AI/ML components.</p></li>
<li><p><strong>Integrate and leverage LLMs/generative AI</strong><br>
Incorporate large language models or generative methods into products and workflows.</p></li>
<li><p><strong>Prototype and experiment</strong><br>
Conduct R&amp;D, proof-of-concepts, and pilot programs to explore emerging AI techniques and validate new product ideas.</p></li>
<li><p><strong>Document and communicate findings</strong><br>
Produce clear technical documentation, share results with stakeholders, and provide actionable insights for decision-making.</p></li>
</ul>
</section>
<section id="skills-1" class="level3">
<h3 class="anchored" data-anchor-id="skills-1">Skills</h3>
<ul>
<li><p><strong>Proficiency in Python</strong><br>
Commonly required for AI/ML development, data manipulation, and scripting.</p></li>
<li><p><strong>Experience with ML/DL frameworks</strong><br>
Hands-on expertise in tools like PyTorch, TensorFlow, or JAX for building and training models.</p></li>
<li><p><strong>Familiarity with cloud platforms</strong><br>
Working knowledge of AWS, GCP, or Azure for deploying and scaling AI solutions.</p></li>
<li><p><strong>Expertise in LLMs/generative AI</strong><br>
Understanding of transformer architectures, prompt engineering, retrieval-augmented generation (RAG), and related libraries.</p></li>
<li><p><strong>Strong software engineering fundamentals</strong><br>
Solid grasp of algorithms, data structures, design patterns, and best practices for production code.</p></li>
<li><p><strong>Knowledge of MLOps and CI/CD</strong><br>
Experience with containerization (Docker, Kubernetes), version control (Git), and automated testing/monitoring.</p></li>
<li><p><strong>Data processing and SQL</strong><br>
Skills in handling large datasets, working with Spark or similar frameworks, and writing performant SQL queries.</p></li>
<li><p><strong>Effective communication and collaboration</strong><br>
Ability to translate complex technical concepts for non-technical stakeholders and work well in diverse teams.</p></li>
<li><p><strong>Problem-solving and debugging</strong><br>
Track record of diagnosing issues in production environments and implementing reliable fixes.</p></li>
<li><p><strong>Continuous learning mindset</strong><br>
Eagerness to stay on top of new AI research, frameworks, and technologies to innovate and improve solutions.</p></li>
</ul>
</section>
</section>
</section>
<section id="job-titles" class="level1">
<h1>Job titles</h1>
<p>What are the most common job titles for these roles?</p>
<div id="78769772" class="cell" data-code-fold-show="false" data-execution_count="16">
<details class="code-fold">
<summary>Click to view the code for aggregating titles</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aggregate_titles_by_role_level(df: pd.DataFrame, output_dir: <span class="bu">str</span> <span class="op">=</span> <span class="st">'role_titles'</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Aggregate job titles for each role_title and level combination and save to JSON.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">        df: DataFrame containing 'role_title', 'level', and 'title' columns</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">        output_dir: Directory to save the JSON output</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create output directory if it doesn't exist</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    os.makedirs(output_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group by role_title and level</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    grouped <span class="op">=</span> df.groupby([<span class="st">'role_title'</span>, <span class="st">'level'</span>])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (role, level), group <span class="kw">in</span> grouped:</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get unique titles for this combination</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> {</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'titles'</span>: group[<span class="st">'title'</span>].unique().tolist()</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create safe filename from role and level</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        safe_role <span class="op">=</span> role.replace(<span class="st">'/'</span>, <span class="st">'_'</span>).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        safe_level <span class="op">=</span> level.replace(<span class="st">'/'</span>, <span class="st">'_'</span>).replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>safe_level<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_role<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Save to JSON file</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(os.path.join(output_dir, filename), <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            json.dump(result, f, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Saved titles for </span><span class="sc">{</span>level<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="4a7d80df" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>aggregate_titles_by_role_level(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved titles for Entry-level AI Research Scientist
Saved titles for Mid-Level / Level AI Research Scientist
Saved titles for Senior-Level / Level AI Research Scientist
Saved titles for Entry-level AI Solution Architect
Saved titles for Mid-Level / Level AI Solution Architect
Saved titles for Senior-Level / Level AI Solution Architect
Saved titles for Entry-level AI/ML Engineer
Saved titles for Mid-Level / Level AI/ML Engineer
Saved titles for Senior-Level / Level AI/ML Engineer
Saved titles for Entry-level MLOps / AI Infrastructure Engineer
Saved titles for Mid-Level / Level MLOps / AI Infrastructure Engineer
Saved titles for Senior-Level / Level MLOps / AI Infrastructure Engineer</code></pre>
</div>
</div>
<p>I’ll use <code>o1</code> again to generate a summary of the most common titles for each role/level combination. In the prompt, I will omit my own role classification so as not to bias the results. I’ll ask it to “identify the most common titles listed below (ignoring slight variations), and then for those titles identify how often they occurred.”</p>
<p>Here’s a sample of what it said.</p>
<p>For Senior AI Research Scientist roles, <code>o1</code> observed the following titles to be common to this role:</p>
<ul>
<li>Research Scientist/Researcher (14 occurrences)</li>
<li>Research Engineer (7 occurrences)</li>
<li>Machine Learning Engineer (3 occurrences)</li>
<li>Generative AI Engineer (2 occurrences)</li>
<li>Software Engineer (Generative AI) (2 occurrences)</li>
</ul>
<p>For Senior AI ML Engineer roles, <code>o1</code> observed the following titles to be common to this role:</p>
<ul>
<li>Senior Software Engineer (6 occurrences)</li>
<li>Senior Machine Learning Engineer (5 occurrences)</li>
<li>Staff Software Engineer (5 occurrences)</li>
<li>Senior AI Engineer (4 occurrences)</li>
<li>Machine Learning Researcher (3 occurrences)</li>
<li>Staff Machine Learning Engineer (2 occurrences)</li>
<li>Principal Software Engineer (2 occurrences)</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tylerburleigh\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><a href="https://creativecommons.org/licenses/by/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i></a> 2014–2025 Tyler Burleigh</span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i>, <a href="https://quarto.org/">Quarto</a>, and the <a href="https://github.com/andrewheiss/ath-quarto">ath-quarto</a> theme</span></p>
</div>
  </div>
</footer>




</body></html>